{"version":3,"sources":["@wordpress/editor/src/components/post-publish-panel/index.js"],"names":["PostPublishPanel","arguments","onSubmit","bind","prevProps","isPublished","props","isSaving","isDirty","onClose","hasPublishAction","isPostTypeViewable","forceIsDirty","forceIsSaving","isBeingScheduled","isPublishSidebarEnabled","isScheduled","onTogglePublishSidebar","PostPublishExtension","PrePublishExtension","additionalProps","propsForPanel","isPublishedOrScheduled","isPrePublish","isPostPublish","closeSmall","Component","select","getPostType","getCurrentPost","getEditedPostAttribute","isCurrentPostPublished","isCurrentPostScheduled","isEditedPostBeingScheduled","isEditedPostDirty","isSavingPost","postType","dispatch","disablePublishSidebar","enablePublishSidebar","withFocusReturn","withConstrainedTabbing"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { get, omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport {\n\tButton,\n\tSpinner,\n\tCheckboxControl,\n\twithFocusReturn,\n\twithConstrainedTabbing,\n} from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { closeSmall } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport PostPublishButton from '../post-publish-button';\nimport PostPublishPanelPrepublish from './prepublish';\nimport PostPublishPanelPostpublish from './postpublish';\n\nexport class PostPublishPanel extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onSubmit = this.onSubmit.bind( this );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\t// Automatically collapse the publish sidebar when a post\n\t\t// is published and the user makes an edit.\n\t\tif (\n\t\t\tprevProps.isPublished &&\n\t\t\t! this.props.isSaving &&\n\t\t\tthis.props.isDirty\n\t\t) {\n\t\t\tthis.props.onClose();\n\t\t}\n\t}\n\n\tonSubmit() {\n\t\tconst { onClose, hasPublishAction, isPostTypeViewable } = this.props;\n\t\tif ( ! hasPublishAction || ! isPostTypeViewable ) {\n\t\t\tonClose();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tforceIsDirty,\n\t\t\tforceIsSaving,\n\t\t\tisBeingScheduled,\n\t\t\tisPublished,\n\t\t\tisPublishSidebarEnabled,\n\t\t\tisScheduled,\n\t\t\tisSaving,\n\t\t\tonClose,\n\t\t\tonTogglePublishSidebar,\n\t\t\tPostPublishExtension,\n\t\t\tPrePublishExtension,\n\t\t\t...additionalProps\n\t\t} = this.props;\n\t\tconst propsForPanel = omit( additionalProps, [\n\t\t\t'hasPublishAction',\n\t\t\t'isDirty',\n\t\t\t'isPostTypeViewable',\n\t\t] );\n\t\tconst isPublishedOrScheduled =\n\t\t\tisPublished || ( isScheduled && isBeingScheduled );\n\t\tconst isPrePublish = ! isPublishedOrScheduled && ! isSaving;\n\t\tconst isPostPublish = isPublishedOrScheduled && ! isSaving;\n\t\treturn (\n\t\t\t<div className=\"editor-post-publish-panel\" { ...propsForPanel }>\n\t\t\t\t<div className=\"editor-post-publish-panel__header\">\n\t\t\t\t\t{ isPostPublish ? (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={ onClose }\n\t\t\t\t\t\t\ticon={ closeSmall }\n\t\t\t\t\t\t\tlabel={ __( 'Close panel' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className=\"editor-post-publish-panel__header-publish-button\">\n\t\t\t\t\t\t\t\t<PostPublishButton\n\t\t\t\t\t\t\t\t\tfocusOnMount={ true }\n\t\t\t\t\t\t\t\t\tonSubmit={ this.onSubmit }\n\t\t\t\t\t\t\t\t\tforceIsDirty={ forceIsDirty }\n\t\t\t\t\t\t\t\t\tforceIsSaving={ forceIsSaving }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"editor-post-publish-panel__header-cancel-button\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={ onClose }\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Close panel' ) }\n\t\t\t\t\t\t\t\t\tisSecondary\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"editor-post-publish-panel__content\">\n\t\t\t\t\t{ isPrePublish && (\n\t\t\t\t\t\t<PostPublishPanelPrepublish>\n\t\t\t\t\t\t\t{ PrePublishExtension && <PrePublishExtension /> }\n\t\t\t\t\t\t</PostPublishPanelPrepublish>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isPostPublish && (\n\t\t\t\t\t\t<PostPublishPanelPostpublish focusOnMount={ true }>\n\t\t\t\t\t\t\t{ PostPublishExtension && <PostPublishExtension /> }\n\t\t\t\t\t\t</PostPublishPanelPostpublish>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isSaving && <Spinner /> }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"editor-post-publish-panel__footer\">\n\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\tlabel={ __( 'Always show pre-publish checks.' ) }\n\t\t\t\t\t\tchecked={ isPublishSidebarEnabled }\n\t\t\t\t\t\tonChange={ onTogglePublishSidebar }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getPostType } = select( 'core' );\n\t\tconst {\n\t\t\tgetCurrentPost,\n\t\t\tgetEditedPostAttribute,\n\t\t\tisCurrentPostPublished,\n\t\t\tisCurrentPostScheduled,\n\t\t\tisEditedPostBeingScheduled,\n\t\t\tisEditedPostDirty,\n\t\t\tisSavingPost,\n\t\t} = select( 'core/editor' );\n\t\tconst { isPublishSidebarEnabled } = select( 'core/editor' );\n\t\tconst postType = getPostType( getEditedPostAttribute( 'type' ) );\n\n\t\treturn {\n\t\t\thasPublishAction: get(\n\t\t\t\tgetCurrentPost(),\n\t\t\t\t[ '_links', 'wp:action-publish' ],\n\t\t\t\tfalse\n\t\t\t),\n\t\t\tisPostTypeViewable: get( postType, [ 'viewable' ], false ),\n\t\t\tisBeingScheduled: isEditedPostBeingScheduled(),\n\t\t\tisDirty: isEditedPostDirty(),\n\t\t\tisPublished: isCurrentPostPublished(),\n\t\t\tisPublishSidebarEnabled: isPublishSidebarEnabled(),\n\t\t\tisSaving: isSavingPost(),\n\t\t\tisScheduled: isCurrentPostScheduled(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { isPublishSidebarEnabled } ) => {\n\t\tconst { disablePublishSidebar, enablePublishSidebar } = dispatch(\n\t\t\t'core/editor'\n\t\t);\n\t\treturn {\n\t\t\tonTogglePublishSidebar: () => {\n\t\t\t\tif ( isPublishSidebarEnabled ) {\n\t\t\t\t\tdisablePublishSidebar();\n\t\t\t\t} else {\n\t\t\t\t\tenablePublishSidebar();\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t} ),\n\twithFocusReturn,\n\twithConstrainedTabbing,\n] )( PostPublishPanel );\n"]}