{"version":3,"sources":["@wordpress/editor/src/components/post-visibility/index.js"],"names":["PostVisibility","props","arguments","setPublic","bind","setPrivate","setPasswordProtected","updatePassword","state","hasPassword","password","visibility","onUpdateVisibility","status","setState","window","confirm","onSave","event","target","value","instanceId","visibilityHandlers","public","onSelect","checked","private","visibilityOptions","map","label","info","Component","select","getEditedPostAttribute","getEditedPostVisibility","dispatch","savePost","editPost","withInstanceId"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { VisuallyHidden } from '@wordpress/components';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { visibilityOptions } from './utils';\n\nexport class PostVisibility extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\n\t\tthis.setPublic = this.setPublic.bind( this );\n\t\tthis.setPrivate = this.setPrivate.bind( this );\n\t\tthis.setPasswordProtected = this.setPasswordProtected.bind( this );\n\t\tthis.updatePassword = this.updatePassword.bind( this );\n\n\t\tthis.state = {\n\t\t\thasPassword: !! props.password,\n\t\t};\n\t}\n\n\tsetPublic() {\n\t\tconst { visibility, onUpdateVisibility, status } = this.props;\n\n\t\tonUpdateVisibility( visibility === 'private' ? 'draft' : status );\n\t\tthis.setState( { hasPassword: false } );\n\t}\n\n\tsetPrivate() {\n\t\tif (\n\t\t\t// eslint-disable-next-line no-alert\n\t\t\t! window.confirm(\n\t\t\t\t__( 'Would you like to privately publish this post now?' )\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { onUpdateVisibility, onSave } = this.props;\n\n\t\tonUpdateVisibility( 'private' );\n\t\tthis.setState( { hasPassword: false } );\n\t\tonSave();\n\t}\n\n\tsetPasswordProtected() {\n\t\tconst { visibility, onUpdateVisibility, status, password } = this.props;\n\n\t\tonUpdateVisibility(\n\t\t\tvisibility === 'private' ? 'draft' : status,\n\t\t\tpassword || ''\n\t\t);\n\t\tthis.setState( { hasPassword: true } );\n\t}\n\n\tupdatePassword( event ) {\n\t\tconst { status, onUpdateVisibility } = this.props;\n\t\tonUpdateVisibility( status, event.target.value );\n\t}\n\n\trender() {\n\t\tconst { visibility, password, instanceId } = this.props;\n\n\t\tconst visibilityHandlers = {\n\t\t\tpublic: {\n\t\t\t\tonSelect: this.setPublic,\n\t\t\t\tchecked: visibility === 'public' && ! this.state.hasPassword,\n\t\t\t},\n\t\t\tprivate: {\n\t\t\t\tonSelect: this.setPrivate,\n\t\t\t\tchecked: visibility === 'private',\n\t\t\t},\n\t\t\tpassword: {\n\t\t\t\tonSelect: this.setPasswordProtected,\n\t\t\t\tchecked: this.state.hasPassword,\n\t\t\t},\n\t\t};\n\n\t\treturn [\n\t\t\t<fieldset\n\t\t\t\tkey=\"visibility-selector\"\n\t\t\t\tclassName=\"editor-post-visibility__dialog-fieldset\"\n\t\t\t>\n\t\t\t\t<legend className=\"editor-post-visibility__dialog-legend\">\n\t\t\t\t\t{ __( 'Post Visibility' ) }\n\t\t\t\t</legend>\n\t\t\t\t{ visibilityOptions.map( ( { value, label, info } ) => (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={ value }\n\t\t\t\t\t\tclassName=\"editor-post-visibility__choice\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\tname={ `editor-post-visibility__setting-${ instanceId }` }\n\t\t\t\t\t\t\tvalue={ value }\n\t\t\t\t\t\t\tonChange={ visibilityHandlers[ value ].onSelect }\n\t\t\t\t\t\t\tchecked={ visibilityHandlers[ value ].checked }\n\t\t\t\t\t\t\tid={ `editor-post-${ value }-${ instanceId }` }\n\t\t\t\t\t\t\taria-describedby={ `editor-post-${ value }-${ instanceId }-description` }\n\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-radio\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\thtmlFor={ `editor-post-${ value }-${ instanceId }` }\n\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-label\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ label }\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t<p\n\t\t\t\t\t\t\t\tid={ `editor-post-${ value }-${ instanceId }-description` }\n\t\t\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-info\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ info }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t) ) }\n\t\t\t</fieldset>,\n\t\t\tthis.state.hasPassword && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"editor-post-visibility__dialog-password\"\n\t\t\t\t\tkey=\"password-selector\"\n\t\t\t\t>\n\t\t\t\t\t<VisuallyHidden\n\t\t\t\t\t\tas=\"label\"\n\t\t\t\t\t\thtmlFor={ `editor-post-visibility__dialog-password-input-${ instanceId }` }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Create password' ) }\n\t\t\t\t\t</VisuallyHidden>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"editor-post-visibility__dialog-password-input\"\n\t\t\t\t\t\tid={ `editor-post-visibility__dialog-password-input-${ instanceId }` }\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tonChange={ this.updatePassword }\n\t\t\t\t\t\tvalue={ password }\n\t\t\t\t\t\tplaceholder={ __( 'Use a secure password' ) }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t),\n\t\t];\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute, getEditedPostVisibility } = select(\n\t\t\t'core/editor'\n\t\t);\n\t\treturn {\n\t\t\tstatus: getEditedPostAttribute( 'status' ),\n\t\t\tvisibility: getEditedPostVisibility(),\n\t\t\tpassword: getEditedPostAttribute( 'password' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { savePost, editPost } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\tonSave: savePost,\n\t\t\tonUpdateVisibility( status, password = '' ) {\n\t\t\t\teditPost( { status, password } );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n] )( PostVisibility );\n"]}