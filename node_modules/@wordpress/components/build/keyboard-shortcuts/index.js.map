{"version":3,"sources":["@wordpress/components/src/keyboard-shortcuts/index.js"],"names":["KeyboardShortcuts","arguments","bindKeyTarget","bind","keyTarget","document","mousetrap","Mousetrap","props","shortcuts","callback","key","process","env","NODE_ENV","keys","split","modifiers","Set","filter","value","length","hasAlt","has","hasShift","size","Error","bindGlobal","eventName","bindFn","reset","node","children","Children","count","Component"],"mappings":";;;;;;;;;AAUA;;;;;;;;;;;;;;AAPA;;AACA;;AACA;;AAUA;;AAfA;;;;AAOA;;;;AAKA;;;IAKMA,iB;;;;;AACL,+BAAc;AAAA;;AAAA;AACb,wHAAUC,SAAV;AAEA,UAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,6CAArB;AAHa;AAIb;;;;wCAEmB;AAAA;;AAAA,4BACc,IADd,CACXC,SADW;AAAA,UACXA,SADW,gCACCC,QADD;AAGnB,WAAKC,SAAL,GAAiB,IAAIC,kBAAJ,CAAeH,SAAf,CAAjB;AAEA,2BAAS,KAAKI,KAAL,CAAWC,SAApB,EAA+B,UAAEC,QAAF,EAAYC,GAAZ,EAAqB;AACnD,YAAKC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAA9B,EAA8C;AAC7C,cAAMC,IAAI,GAAGJ,GAAG,CAACK,KAAJ,CAAW,GAAX,CAAb;AACA,cAAMC,SAAS,GAAG,IAAIC,GAAJ,CAASH,IAAI,CAACI,MAAL,CAAa,UAAEC,KAAF;AAAA,mBAAaA,KAAK,CAACC,MAAN,GAAe,CAA5B;AAAA,WAAb,CAAT,CAAlB;AACA,cAAMC,MAAM,GAAGL,SAAS,CAACM,GAAV,CAAe,KAAf,CAAf;AACA,cAAMC,QAAQ,GAAGP,SAAS,CAACM,GAAV,CAAe,OAAf,CAAjB;;AAEA,cACC,+BACGN,SAAS,CAACQ,IAAV,KAAmB,CAAnB,IAAwBH,MAA1B,IACEL,SAAS,CAACQ,IAAV,KAAmB,CAAnB,IAAwBH,MAAxB,IAAkCE,QAFrC,CADD,EAKE;AACD,kBAAM,IAAIE,KAAJ,uBAA2Bf,GAA3B,qEAAN;AACA;AACD;;AAfkD,2BAiBjB,MAAI,CAACH,KAjBY;AAAA,YAiB3CmB,UAjB2C,gBAiB3CA,UAjB2C;AAAA,YAiB/BC,SAjB+B,gBAiB/BA,SAjB+B;AAkBnD,YAAMC,MAAM,GAAGF,UAAU,GAAG,YAAH,GAAkB,MAA3C;;AACA,QAAA,MAAI,CAACrB,SAAL,CAAgBuB,MAAhB,EAA0BlB,GAA1B,EAA+BD,QAA/B,EAAyCkB,SAAzC;AACA,OApBD;AAqBA;;;2CAEsB;AACtB,WAAKtB,SAAL,CAAewB,KAAf;AACA;AAED;;;;;;;;;kCAMeC,I,EAAO;AACrB,WAAK3B,SAAL,GAAiB2B,IAAjB;AACA;;;6BAEQ;AACR;AACA;AAFQ,UAGAC,QAHA,GAGa,KAAKxB,KAHlB,CAGAwB,QAHA;;AAIR,UAAK,CAAEC,kBAASC,KAAT,CAAgBF,QAAhB,CAAP,EAAoC;AACnC,eAAO,IAAP;AACA;;AAED,aAAO;AAAK,QAAA,GAAG,EAAG,KAAK9B;AAAhB,SAAkC8B,QAAlC,CAAP;AACA;;;EA1D8BG,kB;;eA6DjBnC,iB","sourcesContent":["/**\n * External dependencies\n */\nimport Mousetrap from 'mousetrap';\nimport 'mousetrap/plugins/global-bind/mousetrap-global-bind';\nimport { forEach } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, Children } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { isAppleOS } from './platform';\n\nclass KeyboardShortcuts extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.bindKeyTarget = this.bindKeyTarget.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { keyTarget = document } = this;\n\n\t\tthis.mousetrap = new Mousetrap( keyTarget );\n\n\t\tforEach( this.props.shortcuts, ( callback, key ) => {\n\t\t\tif ( process.env.NODE_ENV === 'development' ) {\n\t\t\t\tconst keys = key.split( '+' );\n\t\t\t\tconst modifiers = new Set( keys.filter( ( value ) => value.length > 1 ) );\n\t\t\t\tconst hasAlt = modifiers.has( 'alt' );\n\t\t\t\tconst hasShift = modifiers.has( 'shift' );\n\n\t\t\t\tif (\n\t\t\t\t\tisAppleOS() && (\n\t\t\t\t\t\t( modifiers.size === 1 && hasAlt ) ||\n\t\t\t\t\t\t( modifiers.size === 2 && hasAlt && hasShift )\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tthrow new Error( `Cannot bind ${ key }. Alt and Shift+Alt modifiers are reserved for character input.` );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst { bindGlobal, eventName } = this.props;\n\t\t\tconst bindFn = bindGlobal ? 'bindGlobal' : 'bind';\n\t\t\tthis.mousetrap[ bindFn ]( key, callback, eventName );\n\t\t} );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.mousetrap.reset();\n\t}\n\n\t/**\n\t * When rendering with children, binds the wrapper node on which events\n\t * will be bound.\n\t *\n\t * @param {Element} node Key event target.\n\t */\n\tbindKeyTarget( node ) {\n\t\tthis.keyTarget = node;\n\t}\n\n\trender() {\n\t\t// Render as non-visual if there are no children pressed. Keyboard\n\t\t// events will be bound to the document instead.\n\t\tconst { children } = this.props;\n\t\tif ( ! Children.count( children ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn <div ref={ this.bindKeyTarget }>{ children }</div>;\n\t}\n}\n\nexport default KeyboardShortcuts;\n"]}