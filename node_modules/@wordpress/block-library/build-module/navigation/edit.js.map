{"version":3,"sources":["@wordpress/block-library/src/navigation/edit.js"],"names":["upperFirst","classnames","useRef","useState","InnerBlocks","InspectorControls","BlockControls","__experimentalUseColors","__experimentalBlock","Block","useDispatch","withSelect","withDispatch","PanelBody","ToggleControl","Toolbar","ToolbarGroup","compose","__","useBlockNavigator","BlockColorsStyleSelector","navIcons","NavigationPlaceholder","Navigation","selectedBlockHasDescendants","attributes","clientId","hasExistingNavItems","isImmediateParentOfSelectedBlock","isSelected","setAttributes","updateInnerBlocks","className","ref","isPlaceholderShown","setIsPlaceholderShown","selectBlock","name","property","contrastCheckers","backgroundColor","textColor","colorDetector","targetRef","colorPanelProps","initialOpen","TextColor","BackgroundColor","ColorPanel","navigatorToolbarButton","navigatorModal","handleItemsAlignment","align","itemsJustification","undefined","blocks","selectNavigationBlock","blockClassNames","orientation","justifyLeftIcon","icon","title","isActive","onClick","justifyCenterIcon","justifyRightIcon","showSubmenuIcon","value","DefaultAppender","select","innerBlocks","getBlocks","getClientIdsOfDescendants","hasSelectedInnerBlock","getSelectedBlockClientId","selectedBlockId","length","dispatch","replaceInnerBlocks"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { upperFirst } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useRef, useState } from '@wordpress/element';\nimport {\n\tInnerBlocks,\n\tInspectorControls,\n\tBlockControls,\n\t__experimentalUseColors,\n\t__experimentalBlock as Block,\n} from '@wordpress/block-editor';\nimport { useDispatch, withSelect, withDispatch } from '@wordpress/data';\nimport {\n\tPanelBody,\n\tToggleControl,\n\tToolbar,\n\tToolbarGroup,\n} from '@wordpress/components';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport useBlockNavigator from './use-block-navigator';\nimport BlockColorsStyleSelector from './block-colors-selector';\nimport * as navIcons from './icons';\nimport NavigationPlaceholder from './placeholder';\n\nfunction Navigation( {\n\tselectedBlockHasDescendants,\n\tattributes,\n\tclientId,\n\thasExistingNavItems,\n\tisImmediateParentOfSelectedBlock,\n\tisSelected,\n\tsetAttributes,\n\tupdateInnerBlocks,\n\tclassName,\n} ) {\n\t//\n\t// HOOKS\n\t//\n\tconst ref = useRef();\n\n\tconst [ isPlaceholderShown, setIsPlaceholderShown ] = useState(\n\t\t! hasExistingNavItems\n\t);\n\n\tconst { selectBlock } = useDispatch( 'core/block-editor' );\n\n\tconst { TextColor, BackgroundColor, ColorPanel } = __experimentalUseColors(\n\t\t[\n\t\t\t{ name: 'textColor', property: 'color' },\n\t\t\t{ name: 'backgroundColor', className: 'has-background' },\n\t\t],\n\t\t{\n\t\t\tcontrastCheckers: [\n\t\t\t\t{\n\t\t\t\t\tbackgroundColor: true,\n\t\t\t\t\ttextColor: true,\n\t\t\t\t},\n\t\t\t],\n\t\t\tcolorDetector: { targetRef: ref },\n\t\t\tcolorPanelProps: {\n\t\t\t\tinitialOpen: true,\n\t\t\t},\n\t\t}\n\t);\n\n\tconst { navigatorToolbarButton, navigatorModal } = useBlockNavigator(\n\t\tclientId\n\t);\n\n\t//\n\t// HANDLERS\n\t//\n\tfunction handleItemsAlignment( align ) {\n\t\treturn () => {\n\t\t\tconst itemsJustification =\n\t\t\t\tattributes.itemsJustification === align ? undefined : align;\n\t\t\tsetAttributes( {\n\t\t\t\titemsJustification,\n\t\t\t} );\n\t\t};\n\t}\n\n\t//\n\t// RENDER\n\t//\n\n\tif ( isPlaceholderShown ) {\n\t\treturn (\n\t\t\t<Block.div>\n\t\t\t\t<NavigationPlaceholder\n\t\t\t\t\tref={ ref }\n\t\t\t\t\tonCreate={ ( blocks, selectNavigationBlock ) => {\n\t\t\t\t\t\tsetIsPlaceholderShown( false );\n\t\t\t\t\t\tupdateInnerBlocks( blocks );\n\t\t\t\t\t\tif ( selectNavigationBlock ) {\n\t\t\t\t\t\t\tselectBlock( clientId );\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t</Block.div>\n\t\t);\n\t}\n\n\tconst blockClassNames = classnames( className, {\n\t\t[ `items-justified-${ attributes.itemsJustification }` ]: attributes.itemsJustification,\n\t\t'is-vertical': attributes.orientation === 'vertical',\n\t} );\n\n\treturn (\n\t\t<>\n\t\t\t<BlockControls>\n\t\t\t\t<Toolbar\n\t\t\t\t\ticon={\n\t\t\t\t\t\tattributes.itemsJustification\n\t\t\t\t\t\t\t? navIcons[\n\t\t\t\t\t\t\t\t\t`justify${ upperFirst(\n\t\t\t\t\t\t\t\t\t\tattributes.itemsJustification\n\t\t\t\t\t\t\t\t\t) }Icon`\n\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t: navIcons.justifyLeftIcon\n\t\t\t\t\t}\n\t\t\t\t\tlabel={ __( 'Change items justification' ) }\n\t\t\t\t\tisCollapsed\n\t\t\t\t\tcontrols={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticon: navIcons.justifyLeftIcon,\n\t\t\t\t\t\t\ttitle: __( 'Justify items left' ),\n\t\t\t\t\t\t\tisActive: 'left' === attributes.itemsJustification,\n\t\t\t\t\t\t\tonClick: handleItemsAlignment( 'left' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticon: navIcons.justifyCenterIcon,\n\t\t\t\t\t\t\ttitle: __( 'Justify items center' ),\n\t\t\t\t\t\t\tisActive:\n\t\t\t\t\t\t\t\t'center' === attributes.itemsJustification,\n\t\t\t\t\t\t\tonClick: handleItemsAlignment( 'center' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticon: navIcons.justifyRightIcon,\n\t\t\t\t\t\t\ttitle: __( 'Justify items right' ),\n\t\t\t\t\t\t\tisActive: 'right' === attributes.itemsJustification,\n\t\t\t\t\t\t\tonClick: handleItemsAlignment( 'right' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t] }\n\t\t\t\t/>\n\t\t\t\t<ToolbarGroup>{ navigatorToolbarButton }</ToolbarGroup>\n\t\t\t\t<BlockColorsStyleSelector\n\t\t\t\t\tTextColor={ TextColor }\n\t\t\t\t\tBackgroundColor={ BackgroundColor }\n\t\t\t\t>\n\t\t\t\t\t{ ColorPanel }\n\t\t\t\t</BlockColorsStyleSelector>\n\t\t\t</BlockControls>\n\t\t\t{ navigatorModal }\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Display settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tchecked={ attributes.showSubmenuIcon }\n\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\tsetAttributes( { showSubmenuIcon: value } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tlabel={ __( 'Show submenu indicator icons' ) }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<TextColor>\n\t\t\t\t<BackgroundColor>\n\t\t\t\t\t<Block.nav className={ blockClassNames }>\n\t\t\t\t\t\t<InnerBlocks\n\t\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\t\tallowedBlocks={ [\n\t\t\t\t\t\t\t\t'core/navigation-link',\n\t\t\t\t\t\t\t\t'core/search',\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\trenderAppender={\n\t\t\t\t\t\t\t\t( isImmediateParentOfSelectedBlock &&\n\t\t\t\t\t\t\t\t\t! selectedBlockHasDescendants ) ||\n\t\t\t\t\t\t\t\tisSelected\n\t\t\t\t\t\t\t\t\t? InnerBlocks.DefaultAppender\n\t\t\t\t\t\t\t\t\t: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttemplateInsertUpdatesSelection={ false }\n\t\t\t\t\t\t\torientation={\n\t\t\t\t\t\t\t\tattributes.orientation || 'horizontal'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t__experimentalTagName=\"ul\"\n\t\t\t\t\t\t\t__experimentalAppenderTagName=\"li\"\n\t\t\t\t\t\t\t__experimentalPassedProps={ {\n\t\t\t\t\t\t\t\tclassName: 'wp-block-navigation__container',\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t__experimentalCaptureToolbars={ true }\n\t\t\t\t\t\t\t// Template lock set to false here so that the Nav\n\t\t\t\t\t\t\t// Block on the experimental menus screen does not\n\t\t\t\t\t\t\t// inherit templateLock={ 'all' }.\n\t\t\t\t\t\t\ttemplateLock={ false }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Block.nav>\n\t\t\t\t</BackgroundColor>\n\t\t\t</TextColor>\n\t\t</>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst innerBlocks = select( 'core/block-editor' ).getBlocks( clientId );\n\t\tconst {\n\t\t\tgetClientIdsOfDescendants,\n\t\t\thasSelectedInnerBlock,\n\t\t\tgetSelectedBlockClientId,\n\t\t} = select( 'core/block-editor' );\n\t\tconst isImmediateParentOfSelectedBlock = hasSelectedInnerBlock(\n\t\t\tclientId,\n\t\t\tfalse\n\t\t);\n\t\tconst selectedBlockId = getSelectedBlockClientId();\n\t\tconst selectedBlockHasDescendants = !! getClientIdsOfDescendants( [\n\t\t\tselectedBlockId,\n\t\t] )?.length;\n\t\treturn {\n\t\t\tisImmediateParentOfSelectedBlock,\n\t\t\tselectedBlockHasDescendants,\n\t\t\thasExistingNavItems: !! innerBlocks.length,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\treturn {\n\t\t\tupdateInnerBlocks( blocks ) {\n\t\t\t\tif ( blocks?.length === 0 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tdispatch( 'core/block-editor' ).replaceInnerBlocks(\n\t\t\t\t\tclientId,\n\t\t\t\t\tblocks\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} ),\n] )( Navigation );\n"]}