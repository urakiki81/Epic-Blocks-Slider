{"version":3,"sources":["@wordpress/block-library/src/media-text/media-container.js"],"names":["classnames","noop","ResizableBox","withNotices","BlockControls","BlockIcon","MediaPlaceholder","MediaReplaceFlow","__","useViewportMatch","useDispatch","icon","ALLOWED_MEDIA_TYPES","imageFillStyles","url","focalPoint","backgroundImage","backgroundPosition","x","y","ResizableBoxContainer","isSelected","isStackedOnMobile","props","isMobile","ToolbarEditButton","mediaId","mediaUrl","onSelectMedia","PlaceholderContainer","className","noticeOperations","noticeUI","onUploadError","message","removeAllNotices","createErrorNotice","title","MediaContainer","commitWidthChange","imageFill","mediaAlt","mediaPosition","mediaType","mediaWidth","onWidthChange","toggleSelection","onResizeStart","onResize","event","direction","elt","parseInt","style","width","onResizeStop","enablePositions","right","left","backgroundStyles","mediaTypeRenderers","image","video"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { ResizableBox, withNotices } from '@wordpress/components';\nimport {\n\tBlockControls,\n\tBlockIcon,\n\tMediaPlaceholder,\n\tMediaReplaceFlow,\n} from '@wordpress/block-editor';\nimport { __ } from '@wordpress/i18n';\nimport { useViewportMatch } from '@wordpress/compose';\nimport { useDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport icon from './media-container-icon';\n\n/**\n * Constants\n */\nconst ALLOWED_MEDIA_TYPES = [ 'image', 'video' ];\n\nexport function imageFillStyles( url, focalPoint ) {\n\treturn url\n\t\t? {\n\t\t\t\tbackgroundImage: `url(${ url })`,\n\t\t\t\tbackgroundPosition: focalPoint\n\t\t\t\t\t? `${ focalPoint.x * 100 }% ${ focalPoint.y * 100 }%`\n\t\t\t\t\t: `50% 50%`,\n\t\t  }\n\t\t: {};\n}\n\nfunction ResizableBoxContainer( { isSelected, isStackedOnMobile, ...props } ) {\n\tconst isMobile = useViewportMatch( 'small', '<' );\n\treturn (\n\t\t<ResizableBox\n\t\t\tshowHandle={ isSelected && ( ! isMobile || ! isStackedOnMobile ) }\n\t\t\t{ ...props }\n\t\t/>\n\t);\n}\n\nfunction ToolbarEditButton( { mediaId, mediaUrl, onSelectMedia } ) {\n\treturn (\n\t\t<BlockControls>\n\t\t\t<MediaReplaceFlow\n\t\t\t\tmediaId={ mediaId }\n\t\t\t\tmediaURL={ mediaUrl }\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\taccept=\"image/*,video/*\"\n\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t/>\n\t\t</BlockControls>\n\t);\n}\n\nfunction PlaceholderContainer( {\n\tclassName,\n\tnoticeOperations,\n\tnoticeUI,\n\tonSelectMedia,\n} ) {\n\tconst onUploadError = ( message ) => {\n\t\tnoticeOperations.removeAllNotices();\n\t\tnoticeOperations.createErrorNotice( message );\n\t};\n\n\treturn (\n\t\t<MediaPlaceholder\n\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\tlabels={ {\n\t\t\t\ttitle: __( 'Media area' ),\n\t\t\t} }\n\t\t\tclassName={ className }\n\t\t\tonSelect={ onSelectMedia }\n\t\t\taccept=\"image/*,video/*\"\n\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\tnotices={ noticeUI }\n\t\t\tonError={ onUploadError }\n\t\t/>\n\t);\n}\n\nfunction MediaContainer( props ) {\n\tconst {\n\t\tclassName,\n\t\tcommitWidthChange,\n\t\tfocalPoint,\n\t\timageFill,\n\t\tisSelected,\n\t\tisStackedOnMobile,\n\t\tmediaAlt,\n\t\tmediaId,\n\t\tmediaPosition,\n\t\tmediaType,\n\t\tmediaUrl,\n\t\tmediaWidth,\n\t\tonSelectMedia,\n\t\tonWidthChange,\n\t} = props;\n\n\tconst { toggleSelection } = useDispatch( 'core/block-editor' );\n\n\tif ( mediaType && mediaUrl ) {\n\t\tconst onResizeStart = () => {\n\t\t\ttoggleSelection( false );\n\t\t};\n\t\tconst onResize = ( event, direction, elt ) => {\n\t\t\tonWidthChange( parseInt( elt.style.width ) );\n\t\t};\n\t\tconst onResizeStop = ( event, direction, elt ) => {\n\t\t\ttoggleSelection( true );\n\t\t\tcommitWidthChange( parseInt( elt.style.width ) );\n\t\t};\n\t\tconst enablePositions = {\n\t\t\tright: mediaPosition === 'left',\n\t\t\tleft: mediaPosition === 'right',\n\t\t};\n\n\t\tconst backgroundStyles =\n\t\t\tmediaType === 'image' && imageFill\n\t\t\t\t? imageFillStyles( mediaUrl, focalPoint )\n\t\t\t\t: {};\n\n\t\tconst mediaTypeRenderers = {\n\t\t\timage: () => <img src={ mediaUrl } alt={ mediaAlt } />,\n\t\t\tvideo: () => <video controls src={ mediaUrl } />,\n\t\t};\n\n\t\treturn (\n\t\t\t<ResizableBoxContainer\n\t\t\t\tas=\"figure\"\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\tclassName,\n\t\t\t\t\t'editor-media-container__resizer'\n\t\t\t\t) }\n\t\t\t\tstyle={ backgroundStyles }\n\t\t\t\tsize={ { width: mediaWidth + '%' } }\n\t\t\t\tminWidth=\"10%\"\n\t\t\t\tmaxWidth=\"100%\"\n\t\t\t\tenable={ enablePositions }\n\t\t\t\tonResizeStart={ onResizeStart }\n\t\t\t\tonResize={ onResize }\n\t\t\t\tonResizeStop={ onResizeStop }\n\t\t\t\taxis=\"x\"\n\t\t\t\tisSelected={ isSelected }\n\t\t\t\tisStackedOnMobile={ isStackedOnMobile }\n\t\t\t>\n\t\t\t\t<ToolbarEditButton\n\t\t\t\t\tonSelectMedia={ onSelectMedia }\n\t\t\t\t\tmediaUrl={ mediaUrl }\n\t\t\t\t\tmediaId={ mediaId }\n\t\t\t\t/>\n\t\t\t\t{ ( mediaTypeRenderers[ mediaType ] || noop )() }\n\t\t\t</ResizableBoxContainer>\n\t\t);\n\t}\n\n\treturn <PlaceholderContainer { ...props } />;\n}\n\nexport default withNotices( MediaContainer );\n"]}