{"version":3,"sources":["@wordpress/block-library/src/cover/edit.native.js"],"names":["View","TouchableWithoutFeedback","Video","requestImageFailedRetryDialog","requestImageUploadCancelDialog","requestImageFullscreenPreview","mediaUploadSync","__","Icon","Image","ImageEditingButton","IMAGE_DEFAULT_FOCAL_POINT","PanelBody","RangeControl","BottomSheet","ToolbarButton","ToolbarGroup","Gradient","ColorPalette","ColorPicker","BottomSheetConsumer","BlockControls","InnerBlocks","InspectorControls","MEDIA_TYPE_IMAGE","MEDIA_TYPE_VIDEO","MediaPlaceholder","MediaUpload","MediaUploadProgress","withColors","__experimentalUseGradient","compose","withPreferredColorScheme","withSelect","withDispatch","useEffect","useState","useRef","cover","icon","replace","image","getProtocol","styles","attributesFromMedia","COVER_MIN_HEIGHT","IMAGE_BACKGROUND_TYPE","VIDEO_BACKGROUND_TYPE","OverlayColorSettings","ALLOWED_MEDIA_TYPES","INNER_BLOCKS_TEMPLATE","align","placeholder","COVER_MAX_HEIGHT","COVER_DEFAULT_HEIGHT","Cover","attributes","getStylesFromColorScheme","isParentSelected","onFocus","overlayColor","setAttributes","openGeneralSidebar","settings","closeSettingsBottomSheet","backgroundType","dimRatio","focalPoint","minHeight","url","id","style","customOverlayColor","CONTAINER_HEIGHT","isImage","THEME_COLORS_COUNT","coverDefaultPalette","colors","slice","gradientValue","hasBackground","color","background","hasOnlyColorBackground","isCustomColorPickerShowing","setCustomColorPickerShowing","customColor","setCustomColor","openMediaOptionsRef","overlay","childrenStyles","defaultColor","isUploadInProgress","setIsUploadInProgress","didUploadFail","setDidUploadFail","shouldShowFailure","onSelectMedia","media","onSelect","onHeightChange","value","onOpactiyChange","onMediaPressed","isVideoLoading","setIsVideoLoading","onVideoLoadStart","onVideoLoad","onClearMedia","undefined","setColor","gradient","customGradient","openColorPicker","backgroundColor","backgroundSolid","backgroundSolidDark","overlayStyles","opacity","overlaySelected","placeholderIconStyle","iconDark","placeholderIcon","toolbarControls","open","addMediaButton","current","selectImageContainer","selectImage","selectImageIcon","controls","rangeCellContainer","clearMediaButton","colorPickerControls","shouldEnableBottomSheetScroll","shouldEnableBottomSheetMaxHeight","onHandleClosingBottomSheet","onHandleHardwareButtonPress","isBottomSheetContentScrolling","renderContent","getMediaOptions","renderBackground","mediaServerId","mediaUrl","imageContainer","width","uri","mediaPlaceholderEmptyStateContainer","height","title","colorPaletteWrapper","paletteColorIndicator","paletteCustomIndicatorWrapper","backgroundContainer","imageEditButton","destructiveButton","label","onPress","separated","content","overlayContainer","uploadFailedContainer","uploadFailed","uploadFailedIcon","select","clientId","getSelectedBlockClientId","selectedBlockClientId","getSettings","dispatch","closeGeneralSidebar"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, TouchableWithoutFeedback } from 'react-native';\nimport Video from 'react-native-video';\n\n/**\n * WordPress dependencies\n */\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n\trequestImageFullscreenPreview,\n\tmediaUploadSync,\n} from '@wordpress/react-native-bridge';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tIcon,\n\tImage,\n\tImageEditingButton,\n\tIMAGE_DEFAULT_FOCAL_POINT,\n\tPanelBody,\n\tRangeControl,\n\tBottomSheet,\n\tToolbarButton,\n\tToolbarGroup,\n\tGradient,\n\tColorPalette,\n\tColorPicker,\n\tBottomSheetConsumer,\n} from '@wordpress/components';\nimport {\n\tBlockControls,\n\tInnerBlocks,\n\tInspectorControls,\n\tMEDIA_TYPE_IMAGE,\n\tMEDIA_TYPE_VIDEO,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tMediaUploadProgress,\n\twithColors,\n\t__experimentalUseGradient,\n} from '@wordpress/block-editor';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { useEffect, useState, useRef } from '@wordpress/element';\nimport { cover as icon, replace, image } from '@wordpress/icons';\nimport { getProtocol } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport {\n\tattributesFromMedia,\n\tCOVER_MIN_HEIGHT,\n\tIMAGE_BACKGROUND_TYPE,\n\tVIDEO_BACKGROUND_TYPE,\n} from './shared';\nimport OverlayColorSettings from './overlay-color-settings';\n\n/**\n * Constants\n */\nconst ALLOWED_MEDIA_TYPES = [ MEDIA_TYPE_IMAGE, MEDIA_TYPE_VIDEO ];\nconst INNER_BLOCKS_TEMPLATE = [\n\t[\n\t\t'core/paragraph',\n\t\t{\n\t\t\talign: 'center',\n\t\t\tplaceholder: __( 'Write title…' ),\n\t\t},\n\t],\n];\nconst COVER_MAX_HEIGHT = 1000;\nconst COVER_DEFAULT_HEIGHT = 300;\n\nconst Cover = ( {\n\tattributes,\n\tgetStylesFromColorScheme,\n\tisParentSelected,\n\tonFocus,\n\toverlayColor,\n\tsetAttributes,\n\topenGeneralSidebar,\n\tsettings,\n\tcloseSettingsBottomSheet,\n} ) => {\n\tconst {\n\t\tbackgroundType,\n\t\tdimRatio,\n\t\tfocalPoint,\n\t\tminHeight,\n\t\turl,\n\t\tid,\n\t\tstyle,\n\t\tcustomOverlayColor,\n\t} = attributes;\n\tconst CONTAINER_HEIGHT = minHeight || COVER_DEFAULT_HEIGHT;\n\tconst isImage = backgroundType === MEDIA_TYPE_IMAGE;\n\n\tconst THEME_COLORS_COUNT = 4;\n\tconst coverDefaultPalette = {\n\t\tcolors: settings.colors.slice( 0, THEME_COLORS_COUNT ),\n\t};\n\n\tconst { gradientValue } = __experimentalUseGradient();\n\n\tconst hasBackground = !! (\n\t\turl ||\n\t\t( style && style.color && style.color.background ) ||\n\t\tattributes.overlayColor ||\n\t\toverlayColor.color ||\n\t\tgradientValue\n\t);\n\n\tconst hasOnlyColorBackground = ! url && hasBackground;\n\n\tconst [\n\t\tisCustomColorPickerShowing,\n\t\tsetCustomColorPickerShowing,\n\t] = useState( false );\n\n\tconst [ customColor, setCustomColor ] = useState( '' );\n\n\tconst openMediaOptionsRef = useRef();\n\n\t// Used to set a default color for its InnerBlocks\n\t// since there's no system to inherit styles yet\n\t// the RichText component will check if there are\n\t// parent styles for the current block. If there are,\n\t// it will use that color instead.\n\tuseEffect( () => {\n\t\t// While we don't support theme colors\n\t\tif ( ! attributes.overlayColor || ( ! attributes.overlay && url ) ) {\n\t\t\tsetAttributes( { childrenStyles: styles.defaultColor } );\n\t\t}\n\t}, [ setAttributes ] );\n\n\t// sync with local media store\n\tuseEffect( mediaUploadSync, [] );\n\n\t// initialize uploading flag to false, awaiting sync\n\tconst [ isUploadInProgress, setIsUploadInProgress ] = useState( false );\n\n\t// initialize upload failure flag to true if url is local\n\tconst [ didUploadFail, setDidUploadFail ] = useState(\n\t\tid && getProtocol( url ) === 'file:'\n\t);\n\n\t// don't show failure if upload is in progress\n\tconst shouldShowFailure = didUploadFail && ! isUploadInProgress;\n\n\tconst onSelectMedia = ( media ) => {\n\t\tsetDidUploadFail( false );\n\t\tconst onSelect = attributesFromMedia( setAttributes );\n\t\tonSelect( media );\n\t};\n\n\tconst onHeightChange = ( value ) => {\n\t\tif ( minHeight || value !== COVER_DEFAULT_HEIGHT ) {\n\t\t\tsetAttributes( { minHeight: value } );\n\t\t}\n\t};\n\n\tconst onOpactiyChange = ( value ) => {\n\t\tsetAttributes( { dimRatio: value } );\n\t};\n\n\tconst onMediaPressed = () => {\n\t\tif ( isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( id );\n\t\t} else if ( shouldShowFailure ) {\n\t\t\trequestImageFailedRetryDialog( id );\n\t\t} else if ( isImage && url ) {\n\t\t\trequestImageFullscreenPreview( url );\n\t\t}\n\t};\n\n\tconst [ isVideoLoading, setIsVideoLoading ] = useState( true );\n\n\tconst onVideoLoadStart = () => {\n\t\tsetIsVideoLoading( true );\n\t};\n\n\tconst onVideoLoad = () => {\n\t\tsetIsVideoLoading( false );\n\t};\n\n\tconst onClearMedia = () => {\n\t\tsetAttributes( { id: undefined, url: undefined } );\n\t\tcloseSettingsBottomSheet();\n\t};\n\n\tfunction setColor( color ) {\n\t\tsetAttributes( {\n\t\t\t// clear all related attributes (only one should be set)\n\t\t\toverlayColor: undefined,\n\t\t\tcustomOverlayColor: color,\n\t\t\tgradient: undefined,\n\t\t\tcustomGradient: undefined,\n\t\t} );\n\t}\n\n\tfunction openColorPicker() {\n\t\tif ( isParentSelected ) {\n\t\t\tsetCustomColorPickerShowing( true );\n\t\t\topenGeneralSidebar();\n\t\t}\n\t}\n\n\tconst backgroundColor = getStylesFromColorScheme(\n\t\tstyles.backgroundSolid,\n\t\tstyles.backgroundSolidDark\n\t);\n\n\tconst overlayStyles = [\n\t\tstyles.overlay,\n\t\turl && { opacity: dimRatio / 100 },\n\t\t! gradientValue && {\n\t\t\tbackgroundColor:\n\t\t\t\tcustomOverlayColor ||\n\t\t\t\toverlayColor?.color ||\n\t\t\t\tstyle?.color?.background ||\n\t\t\t\tstyles.overlay.color,\n\t\t},\n\t\t// While we don't support theme colors we add a default bg color\n\t\t! overlayColor.color && ! url ? backgroundColor : {},\n\t\tisImage &&\n\t\t\tisParentSelected &&\n\t\t\t! isUploadInProgress &&\n\t\t\t! didUploadFail &&\n\t\t\tstyles.overlaySelected,\n\t];\n\n\tconst placeholderIconStyle = getStylesFromColorScheme(\n\t\tstyles.icon,\n\t\tstyles.iconDark\n\t);\n\n\tconst placeholderIcon = <Icon icon={ icon } { ...placeholderIconStyle } />;\n\n\tconst toolbarControls = ( open ) => (\n\t\t<BlockControls>\n\t\t\t<ToolbarGroup>\n\t\t\t\t<ToolbarButton\n\t\t\t\t\ttitle={ __( 'Edit cover media' ) }\n\t\t\t\t\ticon={ replace }\n\t\t\t\t\tonClick={ open }\n\t\t\t\t/>\n\t\t\t</ToolbarGroup>\n\t\t</BlockControls>\n\t);\n\n\tconst addMediaButton = () => (\n\t\t<TouchableWithoutFeedback onPress={ openMediaOptionsRef.current }>\n\t\t\t<View style={ styles.selectImageContainer }>\n\t\t\t\t<View style={ styles.selectImage }>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\tsize={ 16 }\n\t\t\t\t\t\ticon={ image }\n\t\t\t\t\t\t{ ...styles.selectImageIcon }\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n\n\tconst controls = (\n\t\t<InspectorControls>\n\t\t\t<OverlayColorSettings\n\t\t\t\tattributes={ attributes }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t/>\n\t\t\t{ url ? (\n\t\t\t\t<PanelBody>\n\t\t\t\t\t<RangeControl\n\t\t\t\t\t\tlabel={ __( 'Opacity' ) }\n\t\t\t\t\t\tminimumValue={ 0 }\n\t\t\t\t\t\tmaximumValue={ 100 }\n\t\t\t\t\t\tvalue={ dimRatio }\n\t\t\t\t\t\tonChange={ onOpactiyChange }\n\t\t\t\t\t\tstyle={ styles.rangeCellContainer }\n\t\t\t\t\t\tseparatorType={ 'topFullWidth' }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t) : null }\n\t\t\t<PanelBody title={ __( 'Dimensions' ) }>\n\t\t\t\t<RangeControl\n\t\t\t\t\tlabel={ __( 'Minimum height in pixels' ) }\n\t\t\t\t\tminimumValue={ COVER_MIN_HEIGHT }\n\t\t\t\t\tmaximumValue={ COVER_MAX_HEIGHT }\n\t\t\t\t\tvalue={ CONTAINER_HEIGHT }\n\t\t\t\t\tonChange={ onHeightChange }\n\t\t\t\t\tstyle={ styles.rangeCellContainer }\n\t\t\t\t/>\n\t\t\t</PanelBody>\n\n\t\t\t{ url ? (\n\t\t\t\t<PanelBody title={ __( 'Media' ) }>\n\t\t\t\t\t<BottomSheet.Cell\n\t\t\t\t\t\tleftAlign\n\t\t\t\t\t\tlabel={ __( 'Clear Media' ) }\n\t\t\t\t\t\tlabelStyle={ styles.clearMediaButton }\n\t\t\t\t\t\tonPress={ onClearMedia }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t) : null }\n\t\t</InspectorControls>\n\t);\n\n\tconst colorPickerControls = (\n\t\t<InspectorControls>\n\t\t\t<BottomSheetConsumer>\n\t\t\t\t{ ( {\n\t\t\t\t\tshouldEnableBottomSheetScroll,\n\t\t\t\t\tshouldEnableBottomSheetMaxHeight,\n\t\t\t\t\tonHandleClosingBottomSheet,\n\t\t\t\t\tonHandleHardwareButtonPress,\n\t\t\t\t\tisBottomSheetContentScrolling,\n\t\t\t\t} ) => (\n\t\t\t\t\t<ColorPicker\n\t\t\t\t\t\tshouldEnableBottomSheetScroll={\n\t\t\t\t\t\t\tshouldEnableBottomSheetScroll\n\t\t\t\t\t\t}\n\t\t\t\t\t\tshouldEnableBottomSheetMaxHeight={\n\t\t\t\t\t\t\tshouldEnableBottomSheetMaxHeight\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetColor={ ( color ) => {\n\t\t\t\t\t\t\tsetCustomColor( color );\n\t\t\t\t\t\t\tsetColor( color );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonNavigationBack={ closeSettingsBottomSheet }\n\t\t\t\t\t\tonHandleClosingBottomSheet={\n\t\t\t\t\t\t\tonHandleClosingBottomSheet\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonHandleHardwareButtonPress={\n\t\t\t\t\t\t\tonHandleHardwareButtonPress\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonBottomSheetClosed={ () => {\n\t\t\t\t\t\t\tsetCustomColorPickerShowing( false );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tisBottomSheetContentScrolling={\n\t\t\t\t\t\t\tisBottomSheetContentScrolling\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbottomLabelText={ __( 'Select a color' ) }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</BottomSheetConsumer>\n\t\t</InspectorControls>\n\t);\n\n\tconst renderContent = ( getMediaOptions ) => (\n\t\t<>\n\t\t\t{ renderBackground( getMediaOptions ) }\n\t\t\t{ isParentSelected && hasOnlyColorBackground && addMediaButton() }\n\t\t</>\n\t);\n\n\tconst renderBackground = ( getMediaOptions ) => (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isParentSelected }\n\t\t\tonPress={ onMediaPressed }\n\t\t\tonLongPress={ openMediaOptionsRef.current }\n\t\t\tdisabled={ ! isParentSelected }\n\t\t>\n\t\t\t<View style={ [ styles.background, backgroundColor ] }>\n\t\t\t\t{ getMediaOptions() }\n\t\t\t\t{ isParentSelected &&\n\t\t\t\t\tbackgroundType === VIDEO_BACKGROUND_TYPE &&\n\t\t\t\t\ttoolbarControls( openMediaOptionsRef.current ) }\n\t\t\t\t<MediaUploadProgress\n\t\t\t\t\tmediaId={ id }\n\t\t\t\t\tonUpdateMediaProgress={ () => {\n\t\t\t\t\t\tsetIsUploadInProgress( true );\n\t\t\t\t\t} }\n\t\t\t\t\tonFinishMediaUploadWithSuccess={ ( {\n\t\t\t\t\t\tmediaServerId,\n\t\t\t\t\t\tmediaUrl,\n\t\t\t\t\t} ) => {\n\t\t\t\t\t\tsetIsUploadInProgress( false );\n\t\t\t\t\t\tsetDidUploadFail( false );\n\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\tid: mediaServerId,\n\t\t\t\t\t\t\turl: mediaUrl,\n\t\t\t\t\t\t\tbackgroundType,\n\t\t\t\t\t\t} );\n\t\t\t\t\t} }\n\t\t\t\t\tonFinishMediaUploadWithFailure={ () => {\n\t\t\t\t\t\tsetIsUploadInProgress( false );\n\t\t\t\t\t\tsetDidUploadFail( true );\n\t\t\t\t\t} }\n\t\t\t\t\tonMediaUploadStateReset={ () => {\n\t\t\t\t\t\tsetIsUploadInProgress( false );\n\t\t\t\t\t\tsetDidUploadFail( false );\n\t\t\t\t\t\tsetAttributes( { id: undefined, url: undefined } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\n\t\t\t\t{ IMAGE_BACKGROUND_TYPE === backgroundType && (\n\t\t\t\t\t<View style={ styles.imageContainer }>\n\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\teditButton={ false }\n\t\t\t\t\t\t\tfocalPoint={\n\t\t\t\t\t\t\t\tfocalPoint || IMAGE_DEFAULT_FOCAL_POINT\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tisSelected={ isParentSelected }\n\t\t\t\t\t\t\tisUploadFailed={ didUploadFail }\n\t\t\t\t\t\t\tisUploadInProgress={ isUploadInProgress }\n\t\t\t\t\t\t\tonSelectMediaUploadOption={ onSelectMedia }\n\t\t\t\t\t\t\topenMediaOptions={ openMediaOptionsRef.current }\n\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t\twidth={ styles.image.width }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t) }\n\n\t\t\t\t{ VIDEO_BACKGROUND_TYPE === backgroundType && (\n\t\t\t\t\t<Video\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tdisableFocus\n\t\t\t\t\t\trepeat\n\t\t\t\t\t\tresizeMode={ 'cover' }\n\t\t\t\t\t\tsource={ { uri: url } }\n\t\t\t\t\t\tonLoad={ onVideoLoad }\n\t\t\t\t\t\tonLoadStart={ onVideoLoadStart }\n\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\tstyles.background,\n\t\t\t\t\t\t\t// Hide Video component since it has black background while loading the source\n\t\t\t\t\t\t\t{ opacity: isVideoLoading ? 0 : 1 },\n\t\t\t\t\t\t] }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n\n\tif ( ! hasBackground || isCustomColorPickerShowing ) {\n\t\treturn (\n\t\t\t<View>\n\t\t\t\t{ isCustomColorPickerShowing && colorPickerControls }\n\t\t\t\t<MediaPlaceholder\n\t\t\t\t\theight={ styles.mediaPlaceholderEmptyStateContainer.height }\n\t\t\t\t\tbackgroundColor={ customColor }\n\t\t\t\t\thideContent={\n\t\t\t\t\t\tcustomColor !== '' && customColor !== undefined\n\t\t\t\t\t}\n\t\t\t\t\ticon={ placeholderIcon }\n\t\t\t\t\tlabels={ {\n\t\t\t\t\t\ttitle: __( 'Cover' ),\n\t\t\t\t\t} }\n\t\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\tonFocus={ onFocus }\n\t\t\t\t>\n\t\t\t\t\t<View style={ styles.colorPaletteWrapper }>\n\t\t\t\t\t\t<ColorPalette\n\t\t\t\t\t\t\tcustomColorIndicatorStyles={\n\t\t\t\t\t\t\t\tstyles.paletteColorIndicator\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcustomIndicatorWrapperStyles={\n\t\t\t\t\t\t\t\tstyles.paletteCustomIndicatorWrapper\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetColor={ setColor }\n\t\t\t\t\t\t\tonCustomPress={ openColorPicker }\n\t\t\t\t\t\t\tdefaultSettings={ coverDefaultPalette }\n\t\t\t\t\t\t\tshouldShowCustomLabel={ false }\n\t\t\t\t\t\t\tshouldShowCustomVerticalSeparator={ false }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t</MediaPlaceholder>\n\t\t\t</View>\n\t\t);\n\t}\n\n\treturn (\n\t\t<View style={ styles.backgroundContainer }>\n\t\t\t{ controls }\n\n\t\t\t{ isImage &&\n\t\t\t\turl &&\n\t\t\t\topenMediaOptionsRef.current &&\n\t\t\t\tisParentSelected &&\n\t\t\t\t! isUploadInProgress &&\n\t\t\t\t! didUploadFail && (\n\t\t\t\t\t<View style={ styles.imageEditButton }>\n\t\t\t\t\t\t<ImageEditingButton\n\t\t\t\t\t\t\tonSelectMediaUploadOption={ onSelectMedia }\n\t\t\t\t\t\t\topenMediaOptions={ openMediaOptionsRef.current }\n\t\t\t\t\t\t\tpickerOptions={ [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdestructiveButton: true,\n\t\t\t\t\t\t\t\t\tid: 'clearMedia',\n\t\t\t\t\t\t\t\t\tlabel: __( 'Clear Media' ),\n\t\t\t\t\t\t\t\t\tonPress: onClearMedia,\n\t\t\t\t\t\t\t\t\tseparated: true,\n\t\t\t\t\t\t\t\t\tvalue: 'clearMedia',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t) }\n\n\t\t\t<View\n\t\t\t\tpointerEvents=\"box-none\"\n\t\t\t\tstyle={ [ styles.content, { minHeight: CONTAINER_HEIGHT } ] }\n\t\t\t>\n\t\t\t\t<InnerBlocks template={ INNER_BLOCKS_TEMPLATE } />\n\t\t\t</View>\n\n\t\t\t<View pointerEvents=\"none\" style={ styles.overlayContainer }>\n\t\t\t\t<View style={ overlayStyles }>\n\t\t\t\t\t{ gradientValue && (\n\t\t\t\t\t\t<Gradient\n\t\t\t\t\t\t\tgradientValue={ gradientValue }\n\t\t\t\t\t\t\tstyle={ styles.background }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</View>\n\t\t\t</View>\n\n\t\t\t<MediaUpload\n\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\tisReplacingMedia={ ! hasOnlyColorBackground }\n\t\t\t\tonSelect={ onSelectMedia }\n\t\t\t\trender={ ( { open, getMediaOptions } ) => {\n\t\t\t\t\topenMediaOptionsRef.current = open;\n\t\t\t\t\treturn renderContent( getMediaOptions );\n\t\t\t\t} }\n\t\t\t/>\n\n\t\t\t{ shouldShowFailure && (\n\t\t\t\t<View\n\t\t\t\t\tpointerEvents=\"none\"\n\t\t\t\t\tstyle={ styles.uploadFailedContainer }\n\t\t\t\t>\n\t\t\t\t\t<View style={ styles.uploadFailed }>\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\ticon={ 'warning' }\n\t\t\t\t\t\t\t{ ...styles.uploadFailedIcon }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t) }\n\t\t</View>\n\t);\n};\n\nexport default compose( [\n\twithColors( { overlayColor: 'background-color' } ),\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst { getSelectedBlockClientId } = select( 'core/block-editor' );\n\n\t\tconst selectedBlockClientId = getSelectedBlockClientId();\n\n\t\tconst { getSettings } = select( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tsettings: getSettings(),\n\t\t\tisParentSelected: selectedBlockClientId === clientId,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { openGeneralSidebar } = dispatch( 'core/edit-post' );\n\n\t\treturn {\n\t\t\topenGeneralSidebar: () => openGeneralSidebar( 'edit-post/block' ),\n\t\t\tcloseSettingsBottomSheet() {\n\t\t\t\tdispatch( 'core/edit-post' ).closeGeneralSidebar();\n\t\t\t},\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( Cover );\n"]}