{"version":3,"sources":["@wordpress/block-library/src/button/edit.native.js"],"names":["MIN_BORDER_RADIUS_VALUE","MAX_BORDER_RADIUS_VALUE","INITIAL_MAX_WIDTH","ButtonEdit","props","onChangeText","bind","onChangeBorderRadius","onClearSettings","onLayout","onSetMaxWidth","dismissSheet","onShowLinkSettings","onHideLinkSettings","onToggleButtonFocus","setRef","onRemove","getPlaceholderWidth","state","maxWidth","isLinkSheetVisible","isButtonFocused","placeholderTextWidth","prevProps","prevState","selectedId","editorSidebarOpened","parentWidth","Platform","OS","richTextRef","blur","selectedRichText","id","AccessibilityInfo","isScreenReaderEnabled","then","enabled","focus","backgroundColor","attributes","gradientValue","customGradient","colorAndStyleProps","style","background","color","styles","defaultButton","textColor","value","setAttributes","text","borderRadius","setState","url","rel","linkTarget","nativeEvent","width","layout","spacing","marginRight","isParentWidthChanged","isWidthChanged","numOfButtons","onDeleteBlock","onReplace","closeSettingsBottomSheet","isCompatibleWithSettings","actions","label","onPress","options","placeholder","autoFocus","autoFill","openInNewTab","linkRel","richText","placeholderText","textWidth","lines","Math","min","isSelected","clientId","mergeBlocks","paddingTop","borderWidth","borderRadiusValue","Number","isInteger","outlineBorderRadius","minWidth","getBackgroundColor","getTextColor","outline","borderColor","richTextStyle","placeholderTextColor","link","getLinkSettings","Component","withInstanceId","withGradient","select","isEditorSidebarOpened","getSelectedBlockClientId","getBlockCount","getBlockRootClientId","parentId","dispatch","closeGeneralSidebar"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, AccessibilityInfo, Platform, Text } from 'react-native';\n/**\n * WordPress dependencies\n */\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tRichText,\n\twithColors,\n\tInspectorControls,\n\tBlockControls,\n\twithGradient,\n} from '@wordpress/block-editor';\nimport {\n\tPanelBody,\n\tRangeControl,\n\tToolbarGroup,\n\tToolbarButton,\n\tLinkSettings,\n} from '@wordpress/components';\nimport { Component } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { link } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport richTextStyle from './rich-text.scss';\nimport styles from './editor.scss';\nimport ColorBackground from './color-background';\nimport ColorEdit from './color-edit';\nimport getColorAndStyleProps from './color-props';\n\nconst MIN_BORDER_RADIUS_VALUE = 0;\nconst MAX_BORDER_RADIUS_VALUE = 50;\nconst INITIAL_MAX_WIDTH = 108;\n\nclass ButtonEdit extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\t\tthis.onChangeText = this.onChangeText.bind( this );\n\t\tthis.onChangeBorderRadius = this.onChangeBorderRadius.bind( this );\n\t\tthis.onClearSettings = this.onClearSettings.bind( this );\n\t\tthis.onLayout = this.onLayout.bind( this );\n\t\tthis.onSetMaxWidth = this.onSetMaxWidth.bind( this );\n\t\tthis.dismissSheet = this.dismissSheet.bind( this );\n\t\tthis.onShowLinkSettings = this.onShowLinkSettings.bind( this );\n\t\tthis.onHideLinkSettings = this.onHideLinkSettings.bind( this );\n\t\tthis.onToggleButtonFocus = this.onToggleButtonFocus.bind( this );\n\t\tthis.setRef = this.setRef.bind( this );\n\t\tthis.onRemove = this.onRemove.bind( this );\n\t\tthis.getPlaceholderWidth = this.getPlaceholderWidth.bind( this );\n\n\t\tthis.state = {\n\t\t\tmaxWidth: INITIAL_MAX_WIDTH,\n\t\t\tisLinkSheetVisible: false,\n\t\t\tisButtonFocused: true,\n\t\t\tplaceholderTextWidth: 0,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.onSetMaxWidth();\n\t}\n\n\tcomponentDidUpdate( prevProps, prevState ) {\n\t\tconst { selectedId, editorSidebarOpened, parentWidth } = this.props;\n\t\tconst { isLinkSheetVisible, isButtonFocused } = this.state;\n\n\t\tif ( prevProps.selectedId !== selectedId ) {\n\t\t\tthis.onToggleButtonFocus( true );\n\t\t}\n\n\t\tif ( prevProps.parentWidth !== parentWidth ) {\n\t\t\tthis.onSetMaxWidth();\n\t\t}\n\n\t\t// Blur `RichText` on Android when link settings sheet or button settings sheet is opened,\n\t\t// to avoid flashing caret after closing one of them\n\t\tif (\n\t\t\t( ! prevProps.editorSidebarOpened && editorSidebarOpened ) ||\n\t\t\t( ! prevState.isLinkSheetVisible && isLinkSheetVisible )\n\t\t) {\n\t\t\tif ( Platform.OS === 'android' && this.richTextRef ) {\n\t\t\t\tthis.richTextRef.blur();\n\t\t\t\tthis.onToggleButtonFocus( false );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.richTextRef ) {\n\t\t\tconst selectedRichText = this.richTextRef.props.id === selectedId;\n\n\t\t\tif ( ! selectedRichText && isButtonFocused ) {\n\t\t\t\tthis.onToggleButtonFocus( false );\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tselectedRichText &&\n\t\t\t\tselectedId !== prevProps.selectedId &&\n\t\t\t\t! isButtonFocused\n\t\t\t) {\n\t\t\t\tAccessibilityInfo.isScreenReaderEnabled().then( ( enabled ) => {\n\t\t\t\t\tif ( enabled ) {\n\t\t\t\t\t\tthis.onToggleButtonFocus( true );\n\t\t\t\t\t\tthis.richTextRef.focus();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBackgroundColor() {\n\t\tconst { backgroundColor, attributes, gradientValue } = this.props;\n\t\tconst { customGradient } = attributes;\n\n\t\tif ( customGradient || gradientValue ) {\n\t\t\treturn customGradient || gradientValue;\n\t\t}\n\t\tconst colorAndStyleProps = getColorAndStyleProps( attributes );\n\t\treturn (\n\t\t\tcolorAndStyleProps.style?.backgroundColor ||\n\t\t\tcolorAndStyleProps.style?.background ||\n\t\t\t// We still need the `backgroundColor.color` to support colors from the color pallete (not custom ones)\n\t\t\tbackgroundColor.color ||\n\t\t\tstyles.defaultButton.backgroundColor\n\t\t);\n\t}\n\n\tgetTextColor() {\n\t\tconst { textColor, attributes } = this.props;\n\t\tconst colorAndStyleProps = getColorAndStyleProps( attributes );\n\n\t\treturn (\n\t\t\tcolorAndStyleProps.style?.color ||\n\t\t\t// We still need the `textColor.color` to support colors from the color pallete (not custom ones)\n\t\t\ttextColor.color ||\n\t\t\tstyles.defaultButton.color\n\t\t);\n\t}\n\n\tonChangeText( value ) {\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( { text: value } );\n\t}\n\n\tonChangeBorderRadius( value ) {\n\t\tconst { setAttributes } = this.props;\n\t\tsetAttributes( {\n\t\t\tborderRadius: value,\n\t\t} );\n\t}\n\n\tonShowLinkSettings() {\n\t\tthis.setState( { isLinkSheetVisible: true } );\n\t}\n\n\tonHideLinkSettings() {\n\t\tthis.setState( { isLinkSheetVisible: false } );\n\t}\n\n\tonToggleButtonFocus( value ) {\n\t\tthis.setState( { isButtonFocused: value } );\n\t}\n\n\tonClearSettings() {\n\t\tconst { setAttributes } = this.props;\n\n\t\tsetAttributes( {\n\t\t\turl: '',\n\t\t\trel: '',\n\t\t\tlinkTarget: '',\n\t\t} );\n\n\t\tthis.onHideLinkSettings();\n\t}\n\n\tonLayout( { nativeEvent } ) {\n\t\tconst { width } = nativeEvent.layout;\n\t\tthis.onSetMaxWidth( width );\n\t}\n\n\tonSetMaxWidth( width ) {\n\t\tconst { maxWidth } = this.state;\n\t\tconst { parentWidth } = this.props;\n\t\tconst { marginRight: spacing } = styles.defaultButton;\n\n\t\tconst isParentWidthChanged = maxWidth !== parentWidth;\n\t\tconst isWidthChanged = maxWidth !== width;\n\n\t\tif ( parentWidth && ! width && isParentWidthChanged ) {\n\t\t\tthis.setState( {\n\t\t\t\tmaxWidth: parentWidth,\n\t\t\t} );\n\t\t} else if ( ! parentWidth && width && isWidthChanged ) {\n\t\t\tthis.setState( { maxWidth: width - spacing } );\n\t\t}\n\t}\n\n\tonRemove() {\n\t\tconst { numOfButtons, onDeleteBlock, onReplace } = this.props;\n\n\t\tif ( numOfButtons === 1 ) {\n\t\t\tonDeleteBlock();\n\t\t} else {\n\t\t\tonReplace( [] );\n\t\t}\n\t}\n\n\tdismissSheet() {\n\t\tthis.onHideLinkSettings();\n\t\tthis.props.closeSettingsBottomSheet();\n\t}\n\n\tgetLinkSettings( isCompatibleWithSettings ) {\n\t\tconst { isLinkSheetVisible } = this.state;\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst actions = [\n\t\t\t{\n\t\t\t\tlabel: __( 'Remove link' ),\n\t\t\t\tonPress: this.onClearSettings,\n\t\t\t},\n\t\t];\n\n\t\tconst options = {\n\t\t\turl: {\n\t\t\t\tlabel: __( 'Button Link URL' ),\n\t\t\t\tplaceholder: __( 'Add URL' ),\n\t\t\t\tautoFocus: ! isCompatibleWithSettings,\n\t\t\t\tautoFill: true,\n\t\t\t},\n\t\t\topenInNewTab: {\n\t\t\t\tlabel: __( 'Open in new tab' ),\n\t\t\t},\n\t\t\tlinkRel: {\n\t\t\t\tlabel: __( 'Link Rel' ),\n\t\t\t\tplaceholder: __( 'None' ),\n\t\t\t},\n\t\t};\n\n\t\treturn (\n\t\t\t<LinkSettings\n\t\t\t\tisVisible={ isLinkSheetVisible }\n\t\t\t\tattributes={ attributes }\n\t\t\t\tonClose={ this.dismissSheet }\n\t\t\t\tsetAttributes={ setAttributes }\n\t\t\t\twithBottomSheet={ ! isCompatibleWithSettings }\n\t\t\t\tactions={ actions }\n\t\t\t\toptions={ options }\n\t\t\t\tshowIcon={ ! isCompatibleWithSettings }\n\t\t\t/>\n\t\t);\n\t}\n\n\tsetRef( richText ) {\n\t\tthis.richTextRef = richText;\n\t}\n\n\t// Render `Text` with `placeholderText` styled as a placeholder\n\t// to calculate its width which then is set as a `minWidth`\n\tgetPlaceholderWidth( placeholderText ) {\n\t\tconst { maxWidth, placeholderTextWidth } = this.state;\n\t\treturn (\n\t\t\t<Text\n\t\t\t\tstyle={ styles.placeholder }\n\t\t\t\tonTextLayout={ ( { nativeEvent } ) => {\n\t\t\t\t\tconst textWidth =\n\t\t\t\t\t\tnativeEvent.lines[ 0 ] && nativeEvent.lines[ 0 ].width;\n\t\t\t\t\tif ( textWidth && textWidth !== placeholderTextWidth ) {\n\t\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\t\tplaceholderTextWidth: Math.min(\n\t\t\t\t\t\t\t\ttextWidth,\n\t\t\t\t\t\t\t\tmaxWidth\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ placeholderText }\n\t\t\t</Text>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tattributes,\n\t\t\tisSelected,\n\t\t\tclientId,\n\t\t\tonReplace,\n\t\t\tmergeBlocks,\n\t\t\tparentWidth,\n\t\t} = this.props;\n\t\tconst { placeholder, text, borderRadius, url } = attributes;\n\t\tconst { maxWidth, isButtonFocused, placeholderTextWidth } = this.state;\n\t\tconst { paddingTop: spacing, borderWidth } = styles.defaultButton;\n\n\t\tif ( parentWidth === 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst borderRadiusValue = Number.isInteger( borderRadius )\n\t\t\t? borderRadius\n\t\t\t: styles.defaultButton.borderRadius;\n\t\tconst outlineBorderRadius =\n\t\t\tborderRadiusValue > 0\n\t\t\t\t? borderRadiusValue + spacing + borderWidth\n\t\t\t\t: 0;\n\n\t\t// To achieve proper expanding and shrinking `RichText` on iOS, there is a need to set a `minWidth`\n\t\t// value at least on 1 when `RichText` is focused or when is not focused, but `RichText` value is\n\t\t// different than empty string.\n\t\tconst minWidth =\n\t\t\tisButtonFocused || ( ! isButtonFocused && text && text !== '' )\n\t\t\t\t? 1\n\t\t\t\t: placeholderTextWidth;\n\t\t// To achieve proper expanding and shrinking `RichText` on Android, there is a need to set\n\t\t// a `placeholder` as an empty string when `RichText` is focused,\n\t\t// because `AztecView` is calculating a `minWidth` based on placeholder text.\n\t\tconst placeholderText =\n\t\t\tisButtonFocused || ( ! isButtonFocused && text && text !== '' )\n\t\t\t\t? ''\n\t\t\t\t: placeholder || __( 'Add text…' );\n\n\t\tconst backgroundColor = this.getBackgroundColor();\n\t\tconst textColor = this.getTextColor();\n\n\t\treturn (\n\t\t\t<View onLayout={ this.onLayout }>\n\t\t\t\t{ this.getPlaceholderWidth( placeholderText ) }\n\t\t\t\t<ColorBackground\n\t\t\t\t\tborderRadiusValue={ borderRadiusValue }\n\t\t\t\t\tbackgroundColor={ backgroundColor }\n\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t>\n\t\t\t\t\t{ isSelected && (\n\t\t\t\t\t\t<View\n\t\t\t\t\t\t\tpointerEvents=\"none\"\n\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\tstyles.outline,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tborderRadius: outlineBorderRadius,\n\t\t\t\t\t\t\t\t\tborderColor: backgroundColor,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<RichText\n\t\t\t\t\t\tsetRef={ this.setRef }\n\t\t\t\t\t\tplaceholder={ placeholderText }\n\t\t\t\t\t\tvalue={ text }\n\t\t\t\t\t\tonChange={ this.onChangeText }\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t...richTextStyle.richText,\n\t\t\t\t\t\t\tcolor: textColor,\n\t\t\t\t\t\t} }\n\t\t\t\t\t\ttextAlign=\"center\"\n\t\t\t\t\t\tplaceholderTextColor={\n\t\t\t\t\t\t\tstyles.placeholderTextColor.color\n\t\t\t\t\t\t}\n\t\t\t\t\t\tidentifier=\"text\"\n\t\t\t\t\t\ttagName=\"p\"\n\t\t\t\t\t\tminWidth={ minWidth }\n\t\t\t\t\t\tmaxWidth={ maxWidth }\n\t\t\t\t\t\tid={ clientId }\n\t\t\t\t\t\tisSelected={ isButtonFocused }\n\t\t\t\t\t\twithoutInteractiveFormatting\n\t\t\t\t\t\tunstableOnFocus={ () =>\n\t\t\t\t\t\t\tthis.onToggleButtonFocus( true )\n\t\t\t\t\t\t}\n\t\t\t\t\t\t__unstableMobileNoFocusOnMount={ ! isSelected }\n\t\t\t\t\t\tselectionColor={ textColor }\n\t\t\t\t\t\tonBlur={ () => {\n\t\t\t\t\t\t\tthis.onSetMaxWidth();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonReplace={ onReplace }\n\t\t\t\t\t\tonRemove={ this.onRemove }\n\t\t\t\t\t\tonMerge={ mergeBlocks }\n\t\t\t\t\t/>\n\t\t\t\t</ColorBackground>\n\n\t\t\t\t{ isSelected && (\n\t\t\t\t\t<BlockControls>\n\t\t\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\ttitle={ __( 'Edit link' ) }\n\t\t\t\t\t\t\t\ticon={ link }\n\t\t\t\t\t\t\t\tonClick={ this.onShowLinkSettings }\n\t\t\t\t\t\t\t\tisActive={ url }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</ToolbarGroup>\n\t\t\t\t\t</BlockControls>\n\t\t\t\t) }\n\n\t\t\t\t{ this.getLinkSettings( false ) }\n\n\t\t\t\t<ColorEdit { ...this.props } />\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody title={ __( 'Border Settings' ) }>\n\t\t\t\t\t\t<RangeControl\n\t\t\t\t\t\t\tlabel={ __( 'Border Radius' ) }\n\t\t\t\t\t\t\tminimumValue={ MIN_BORDER_RADIUS_VALUE }\n\t\t\t\t\t\t\tmaximumValue={ MAX_BORDER_RADIUS_VALUE }\n\t\t\t\t\t\t\tvalue={ borderRadiusValue }\n\t\t\t\t\t\t\tonChange={ this.onChangeBorderRadius }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t\t<PanelBody title={ __( 'Link Settings' ) }>\n\t\t\t\t\t\t{ this.getLinkSettings( true ) }\n\t\t\t\t\t</PanelBody>\n\t\t\t\t</InspectorControls>\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithInstanceId,\n\twithGradient,\n\twithColors( 'backgroundColor', { textColor: 'color' } ),\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst { isEditorSidebarOpened } = select( 'core/edit-post' );\n\t\tconst {\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockCount,\n\t\t\tgetBlockRootClientId,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst parentId = getBlockRootClientId( clientId );\n\t\tconst selectedId = getSelectedBlockClientId();\n\t\tconst numOfButtons = getBlockCount( parentId );\n\n\t\treturn {\n\t\t\tselectedId,\n\t\t\teditorSidebarOpened: isEditorSidebarOpened(),\n\t\t\tnumOfButtons,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\treturn {\n\t\t\tcloseSettingsBottomSheet() {\n\t\t\t\tdispatch( 'core/edit-post' ).closeGeneralSidebar();\n\t\t\t},\n\t\t};\n\t} ),\n] )( ButtonEdit );\n"]}