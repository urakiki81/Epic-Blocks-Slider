{"version":3,"sources":["@wordpress/block-library/src/template-part/edit/use-template-part-post.js"],"names":["useTemplatePartPost","postId","slug","theme","select","getEntityRecord","cleanedSlug","posts","getEntityRecords","status","foundPosts","filter","post","meta","foundPost","find","id"],"mappings":";;;;;;;AAGA;;AACA;;AAJA;;;AAMe,SAASA,mBAAT,CAA8BC,MAA9B,EAAsCC,IAAtC,EAA4CC,KAA5C,EAAoD;AAClE,SAAO,qBACN,UAAEC,MAAF,EAAc;AACb,QAAKH,MAAL,EAAc;AACb;AACA;AACA,aACCG,MAAM,CAAE,MAAF,CAAN,CAAiBC,eAAjB,CACC,UADD,EAEC,kBAFD,EAGCJ,MAHD,KAIKA,MALN;AAOA,KAXY,CAab;AACA;AACA;;;AACA,QAAKC,IAAI,IAAIC,KAAb,EAAqB;AACpB,UAAMG,WAAW,GAAG,uBAAcJ,IAAd,CAApB;AACA,UAAMK,KAAK,GAAGH,MAAM,CAAE,MAAF,CAAN,CAAiBI,gBAAjB,CACb,UADa,EAEb,kBAFa,EAGb;AACCC,QAAAA,MAAM,EAAE,CAAE,SAAF,EAAa,YAAb,CADT;AAECP,QAAAA,IAAI,EAAEI,WAFP;AAGCH,QAAAA,KAAK,EAALA;AAHD,OAHa,CAAd;AASA,UAAMO,UAAU,GAAGH,KAAH,aAAGA,KAAH,uBAAGA,KAAK,CAAEI,MAAP,CAClB,UAAEC,IAAF;AAAA,eACCA,IAAI,CAACV,IAAL,KAAcI,WAAd,IACAM,IAAI,CAACC,IADL,IAEAD,IAAI,CAACC,IAAL,CAAUV,KAAV,KAAoBA,KAHrB;AAAA,OADkB,CAAnB,CAXoB,CAiBpB;AACA;;AACA,UAAMW,SAAS,GACd,CAAAJ,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEK,IAAZ,CAAkB,UAAEH,IAAF;AAAA,eAAYA,IAAI,CAACH,MAAL,KAAgB,SAA5B;AAAA,OAAlB,OACAC,UADA,aACAA,UADA,uBACAA,UAAU,CAAEK,IAAZ,CACC,UAAEH,IAAF;AAAA,eAAYA,IAAI,CAACH,MAAL,KAAgB,YAA5B;AAAA,OADD,CADA,CADD;AAKA,aAAOK,SAAP,aAAOA,SAAP,uBAAOA,SAAS,CAAEE,EAAlB;AACA;AACD,GA3CK,EA4CN,CAAEf,MAAF,EAAUC,IAAV,EAAgBC,KAAhB,CA5CM,CAAP;AA8CA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { cleanForSlug } from '@wordpress/url';\n\nexport default function useTemplatePartPost( postId, slug, theme ) {\n\treturn useSelect(\n\t\t( select ) => {\n\t\t\tif ( postId ) {\n\t\t\t\t// This is already a custom template part,\n\t\t\t\t// use its CPT post.\n\t\t\t\treturn (\n\t\t\t\t\tselect( 'core' ).getEntityRecord(\n\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t'wp_template_part',\n\t\t\t\t\t\tpostId\n\t\t\t\t\t) && postId\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// This is not a custom template part,\n\t\t\t// load the auto-draft created from the\n\t\t\t// relevant file.\n\t\t\tif ( slug && theme ) {\n\t\t\t\tconst cleanedSlug = cleanForSlug( slug );\n\t\t\t\tconst posts = select( 'core' ).getEntityRecords(\n\t\t\t\t\t'postType',\n\t\t\t\t\t'wp_template_part',\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus: [ 'publish', 'auto-draft' ],\n\t\t\t\t\t\tslug: cleanedSlug,\n\t\t\t\t\t\ttheme,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tconst foundPosts = posts?.filter(\n\t\t\t\t\t( post ) =>\n\t\t\t\t\t\tpost.slug === cleanedSlug &&\n\t\t\t\t\t\tpost.meta &&\n\t\t\t\t\t\tpost.meta.theme === theme\n\t\t\t\t);\n\t\t\t\t// A published post might already exist if this template part was customized elsewhere\n\t\t\t\t// or if it's part of a customized template.\n\t\t\t\tconst foundPost =\n\t\t\t\t\tfoundPosts?.find( ( post ) => post.status === 'publish' ) ||\n\t\t\t\t\tfoundPosts?.find(\n\t\t\t\t\t\t( post ) => post.status === 'auto-draft'\n\t\t\t\t\t);\n\t\t\t\treturn foundPost?.id;\n\t\t\t}\n\t\t},\n\t\t[ postId, slug, theme ]\n\t);\n}\n"]}