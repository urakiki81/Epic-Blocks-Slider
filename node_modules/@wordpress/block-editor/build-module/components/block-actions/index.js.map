{"version":3,"sources":["@wordpress/block-editor/src/components/block-actions/index.js"],"names":["castArray","first","last","every","useDispatch","useSelect","hasBlockSupport","switchToBlockType","useNotifyCopy","BlockActions","clientIds","children","updateSelection","__experimentalUpdateSelection","select","canInsertBlockType","getBlockRootClientId","getBlocksByClientId","getTemplateLock","getDefaultBlockName","getGroupingBlockName","blocks","rootClientId","canDuplicate","block","name","canInsertDefaultBlock","removeBlocks","replaceBlocks","duplicateBlocks","insertAfterBlock","insertBeforeBlock","flashBlock","setBlockMovingClientId","setNavigationMode","notifyCopy","isLocked","onDuplicate","onRemove","onInsertBefore","onInsertAfter","onMoveTo","onGroup","length","groupingBlockName","newBlocks","onUngroup","innerBlocks","onCopy","selectedBlockClientIds","map","clientId"],"mappings":"AAAA;;;AAGA,SAASA,SAAT,EAAoBC,KAApB,EAA2BC,IAA3B,EAAiCC,KAAjC,QAA8C,QAA9C;AAEA;;;;AAGA,SAASC,WAAT,EAAsBC,SAAtB,QAAuC,iBAAvC;AACA,SAASC,eAAT,EAA0BC,iBAA1B,QAAmD,mBAAnD;AAEA;;;;AAGA,SAASC,aAAT,QAA8B,iBAA9B;AAEA,eAAe,SAASC,YAAT,OAIX;AAAA,MAHHC,SAGG,QAHHA,SAGG;AAAA,MAFHC,QAEG,QAFHA,QAEG;AAAA,MAD4BC,eAC5B,QADHC,6BACG;;AAAA,mBAMCR,SAAS,CAAE,UAAES,MAAF;AAAA,WAAcA,MAAM,CAAE,mBAAF,CAApB;AAAA,GAAF,EAA+C,EAA/C,CANV;AAAA,MAEFC,kBAFE,cAEFA,kBAFE;AAAA,MAGFC,oBAHE,cAGFA,oBAHE;AAAA,MAIFC,mBAJE,cAIFA,mBAJE;AAAA,MAKFC,eALE,cAKFA,eALE;;AAAA,oBAOmDb,SAAS,CAC9D,UAAES,MAAF;AAAA,WAAcA,MAAM,CAAE,aAAF,CAApB;AAAA,GAD8D,EAE9D,EAF8D,CAP5D;AAAA,MAOKK,mBAPL,eAOKA,mBAPL;AAAA,MAO0BC,oBAP1B,eAO0BA,oBAP1B;;AAYH,MAAMC,MAAM,GAAGJ,mBAAmB,CAAEP,SAAF,CAAlC;AACA,MAAMY,YAAY,GAAGN,oBAAoB,CAAEN,SAAS,CAAE,CAAF,CAAX,CAAzC;AACA,MAAMa,YAAY,GAAGpB,KAAK,CAAEkB,MAAF,EAAU,UAAEG,KAAF,EAAa;AAChD,WACC,CAAC,CAAEA,KAAH,IACAlB,eAAe,CAAEkB,KAAK,CAACC,IAAR,EAAc,UAAd,EAA0B,IAA1B,CADf,IAEAV,kBAAkB,CAAES,KAAK,CAACC,IAAR,EAAcH,YAAd,CAHnB;AAKA,GANyB,CAA1B;AAQA,MAAMI,qBAAqB,GAAGX,kBAAkB,CAC/CI,mBAAmB,EAD4B,EAE/CG,YAF+C,CAAhD;;AAtBG,qBAoCClB,WAAW,CAAE,mBAAF,CApCZ;AAAA,MA4BFuB,YA5BE,gBA4BFA,YA5BE;AAAA,MA6BFC,aA7BE,gBA6BFA,aA7BE;AAAA,MA8BFC,eA9BE,gBA8BFA,eA9BE;AAAA,MA+BFC,gBA/BE,gBA+BFA,gBA/BE;AAAA,MAgCFC,iBAhCE,gBAgCFA,iBAhCE;AAAA,MAiCFC,UAjCE,gBAiCFA,UAjCE;AAAA,MAkCFC,sBAlCE,gBAkCFA,sBAlCE;AAAA,MAmCFC,iBAnCE,gBAmCFA,iBAnCE;;AAsCH,MAAMC,UAAU,GAAG3B,aAAa,EAAhC;AAEA,SAAOG,QAAQ,CAAE;AAChBY,IAAAA,YAAY,EAAZA,YADgB;AAEhBG,IAAAA,qBAAqB,EAArBA,qBAFgB;AAGhBU,IAAAA,QAAQ,EAAE,CAAC,CAAElB,eAAe,CAAEI,YAAF,CAHZ;AAIhBA,IAAAA,YAAY,EAAZA,YAJgB;AAKhBD,IAAAA,MAAM,EAANA,MALgB;AAMhBgB,IAAAA,WANgB,yBAMF;AACb,aAAOR,eAAe,CAAEnB,SAAF,EAAaE,eAAb,CAAtB;AACA,KARe;AAShB0B,IAAAA,QATgB,sBASL;AACV,aAAOX,YAAY,CAAEjB,SAAF,EAAaE,eAAb,CAAnB;AACA,KAXe;AAYhB2B,IAAAA,cAZgB,4BAYC;AAChBR,MAAAA,iBAAiB,CAAE9B,KAAK,CAAED,SAAS,CAAEU,SAAF,CAAX,CAAP,CAAjB;AACA,KAde;AAehB8B,IAAAA,aAfgB,2BAeA;AACfV,MAAAA,gBAAgB,CAAE5B,IAAI,CAAEF,SAAS,CAAEU,SAAF,CAAX,CAAN,CAAhB;AACA,KAjBe;AAkBhB+B,IAAAA,QAlBgB,sBAkBL;AACVP,MAAAA,iBAAiB,CAAE,IAAF,CAAjB;AACAD,MAAAA,sBAAsB,CAAEvB,SAAS,CAAE,CAAF,CAAX,CAAtB;AACA,KArBe;AAsBhBgC,IAAAA,OAtBgB,qBAsBN;AACT,UAAK,CAAErB,MAAM,CAACsB,MAAd,EAAuB;AACtB;AACA;;AAED,UAAMC,iBAAiB,GAAGxB,oBAAoB,EAA9C,CALS,CAOT;;AACA,UAAMyB,SAAS,GAAGtC,iBAAiB,CAAEc,MAAF,EAAUuB,iBAAV,CAAnC;;AAEA,UAAK,CAAEC,SAAP,EAAmB;AAClB;AACA;;AACDjB,MAAAA,aAAa,CAAElB,SAAF,EAAamC,SAAb,CAAb;AACA,KApCe;AAqChBC,IAAAA,SArCgB,uBAqCJ;AACX,UAAK,CAAEzB,MAAM,CAACsB,MAAd,EAAuB;AACtB;AACA;;AAED,UAAMI,WAAW,GAAG1B,MAAM,CAAE,CAAF,CAAN,CAAY0B,WAAhC;;AAEA,UAAK,CAAEA,WAAW,CAACJ,MAAnB,EAA4B;AAC3B;AACA;;AAEDf,MAAAA,aAAa,CAAElB,SAAF,EAAaqC,WAAb,CAAb;AACA,KAjDe;AAkDhBC,IAAAA,MAlDgB,oBAkDP;AACR,UAAMC,sBAAsB,GAAG5B,MAAM,CAAC6B,GAAP,CAC9B;AAAA,YAAIC,QAAJ,SAAIA,QAAJ;AAAA,eAAoBA,QAApB;AAAA,OAD8B,CAA/B;;AAGA,UAAK9B,MAAM,CAACsB,MAAP,KAAkB,CAAvB,EAA2B;AAC1BX,QAAAA,UAAU,CAAEiB,sBAAsB,CAAE,CAAF,CAAxB,CAAV;AACA;;AACDd,MAAAA,UAAU,CAAE,MAAF,EAAUc,sBAAV,CAAV;AACA;AA1De,GAAF,CAAf;AA4DA","sourcesContent":["/**\n * External dependencies\n */\nimport { castArray, first, last, every } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { hasBlockSupport, switchToBlockType } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport { useNotifyCopy } from '../copy-handler';\n\nexport default function BlockActions( {\n\tclientIds,\n\tchildren,\n\t__experimentalUpdateSelection: updateSelection,\n} ) {\n\tconst {\n\t\tcanInsertBlockType,\n\t\tgetBlockRootClientId,\n\t\tgetBlocksByClientId,\n\t\tgetTemplateLock,\n\t} = useSelect( ( select ) => select( 'core/block-editor' ), [] );\n\tconst { getDefaultBlockName, getGroupingBlockName } = useSelect(\n\t\t( select ) => select( 'core/blocks' ),\n\t\t[]\n\t);\n\n\tconst blocks = getBlocksByClientId( clientIds );\n\tconst rootClientId = getBlockRootClientId( clientIds[ 0 ] );\n\tconst canDuplicate = every( blocks, ( block ) => {\n\t\treturn (\n\t\t\t!! block &&\n\t\t\thasBlockSupport( block.name, 'multiple', true ) &&\n\t\t\tcanInsertBlockType( block.name, rootClientId )\n\t\t);\n\t} );\n\n\tconst canInsertDefaultBlock = canInsertBlockType(\n\t\tgetDefaultBlockName(),\n\t\trootClientId\n\t);\n\n\tconst {\n\t\tremoveBlocks,\n\t\treplaceBlocks,\n\t\tduplicateBlocks,\n\t\tinsertAfterBlock,\n\t\tinsertBeforeBlock,\n\t\tflashBlock,\n\t\tsetBlockMovingClientId,\n\t\tsetNavigationMode,\n\t} = useDispatch( 'core/block-editor' );\n\n\tconst notifyCopy = useNotifyCopy();\n\n\treturn children( {\n\t\tcanDuplicate,\n\t\tcanInsertDefaultBlock,\n\t\tisLocked: !! getTemplateLock( rootClientId ),\n\t\trootClientId,\n\t\tblocks,\n\t\tonDuplicate() {\n\t\t\treturn duplicateBlocks( clientIds, updateSelection );\n\t\t},\n\t\tonRemove() {\n\t\t\treturn removeBlocks( clientIds, updateSelection );\n\t\t},\n\t\tonInsertBefore() {\n\t\t\tinsertBeforeBlock( first( castArray( clientIds ) ) );\n\t\t},\n\t\tonInsertAfter() {\n\t\t\tinsertAfterBlock( last( castArray( clientIds ) ) );\n\t\t},\n\t\tonMoveTo() {\n\t\t\tsetNavigationMode( true );\n\t\t\tsetBlockMovingClientId( clientIds[ 0 ] );\n\t\t},\n\t\tonGroup() {\n\t\t\tif ( ! blocks.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst groupingBlockName = getGroupingBlockName();\n\n\t\t\t// Activate the `transform` on `core/group` which does the conversion\n\t\t\tconst newBlocks = switchToBlockType( blocks, groupingBlockName );\n\n\t\t\tif ( ! newBlocks ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treplaceBlocks( clientIds, newBlocks );\n\t\t},\n\t\tonUngroup() {\n\t\t\tif ( ! blocks.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst innerBlocks = blocks[ 0 ].innerBlocks;\n\n\t\t\tif ( ! innerBlocks.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treplaceBlocks( clientIds, innerBlocks );\n\t\t},\n\t\tonCopy() {\n\t\t\tconst selectedBlockClientIds = blocks.map(\n\t\t\t\t( { clientId } ) => clientId\n\t\t\t);\n\t\t\tif ( blocks.length === 1 ) {\n\t\t\t\tflashBlock( selectedBlockClientIds[ 0 ] );\n\t\t\t}\n\t\t\tnotifyCopy( 'copy', selectedBlockClientIds );\n\t\t},\n\t} );\n}\n"]}