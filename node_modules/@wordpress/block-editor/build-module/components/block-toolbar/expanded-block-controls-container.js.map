{"version":3,"sources":["@wordpress/block-editor/src/components/block-toolbar/expanded-block-controls-container.js"],"names":["TransitionGroup","CSSTransition","throttle","useRef","useState","useEffect","useCallback","warning","BlockControls","ExpandedBlockControlsContainer","children","className","fills","ExpandedBlockControlsHandler","containerRef","fillsRef","toolbarRef","dimensions","setDimensions","fillsPropRef","current","resizeToolbar","toolbarContentElement","length","style","position","width","contentCSS","window","getComputedStyle","getPropertyValue","height","observer","MutationObserver","mutationsList","hasChildList","find","type","observe","childList","subtree","disconnect","displayFill"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { TransitionGroup, CSSTransition } from 'react-transition-group';\nimport { throttle } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useRef, useState, useEffect, useCallback } from '@wordpress/element';\nimport warning from '@wordpress/warning';\n\n/**\n * Internal dependencies\n */\nimport BlockControls from '../block-controls';\n\nexport default function ExpandedBlockControlsContainer( {\n\tchildren,\n\tclassName,\n} ) {\n\treturn (\n\t\t<BlockControls.Slot __experimentalIsExpanded>\n\t\t\t{ ( fills ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<ExpandedBlockControlsHandler\n\t\t\t\t\t\tclassName={ className }\n\t\t\t\t\t\tfills={ fills }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t</ExpandedBlockControlsHandler>\n\t\t\t\t);\n\t\t\t} }\n\t\t</BlockControls.Slot>\n\t);\n}\n\nfunction ExpandedBlockControlsHandler( { fills, className = '', children } ) {\n\tconst containerRef = useRef();\n\tconst fillsRef = useRef();\n\tconst toolbarRef = useRef();\n\tconst [ dimensions, setDimensions ] = useState( {} );\n\n\tconst fillsPropRef = useRef();\n\tfillsPropRef.current = fills;\n\tconst resizeToolbar = useCallback(\n\t\tthrottle( () => {\n\t\t\tconst toolbarContentElement = fillsPropRef.current.length\n\t\t\t\t? fillsRef.current\n\t\t\t\t: toolbarRef.current;\n\t\t\tif ( ! toolbarContentElement ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttoolbarContentElement.style.position = 'absolute';\n\t\t\ttoolbarContentElement.style.width = 'auto';\n\t\t\tconst contentCSS = window.getComputedStyle(\n\t\t\t\ttoolbarContentElement,\n\t\t\t\tnull\n\t\t\t);\n\t\t\tsetDimensions( {\n\t\t\t\twidth: contentCSS.getPropertyValue( 'width' ),\n\t\t\t\theight: contentCSS.getPropertyValue( 'height' ),\n\t\t\t} );\n\t\t\ttoolbarContentElement.style.position = '';\n\t\t\ttoolbarContentElement.style.width = '';\n\t\t}, 100 ),\n\t\t[]\n\t);\n\n\tuseEffect( () => {\n\t\tconst observer = new window.MutationObserver( function (\n\t\t\tmutationsList\n\t\t) {\n\t\t\tconst hasChildList = mutationsList.find(\n\t\t\t\t( { type } ) => type === 'childList'\n\t\t\t);\n\t\t\tif ( hasChildList ) {\n\t\t\t\tresizeToolbar();\n\t\t\t}\n\t\t} );\n\n\t\tobserver.observe( containerRef.current, {\n\t\t\tchildList: true,\n\t\t\tsubtree: true,\n\t\t} );\n\n\t\treturn () => observer.disconnect();\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( fills.length > 1 ) {\n\t\t\twarning(\n\t\t\t\t`${ fills.length } <BlockControls isExpanded> slots were registered but only one may be displayed.`\n\t\t\t);\n\t\t}\n\t}, [ fills.length ] );\n\n\tconst displayFill = fills[ 0 ];\n\treturn (\n\t\t<div\n\t\t\tclassName=\"block-editor-block-toolbar-animated-width-container\"\n\t\t\tref={ containerRef }\n\t\t\tstyle={ dimensions }\n\t\t>\n\t\t\t<TransitionGroup>\n\t\t\t\t{ displayFill ? (\n\t\t\t\t\t<CSSTransition\n\t\t\t\t\t\tkey=\"fills\"\n\t\t\t\t\t\ttimeout={ 300 }\n\t\t\t\t\t\tclassNames=\"block-editor-block-toolbar-content\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className={ className } ref={ fillsRef }>\n\t\t\t\t\t\t\t{ displayFill }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CSSTransition>\n\t\t\t\t) : (\n\t\t\t\t\t<CSSTransition\n\t\t\t\t\t\tkey=\"default\"\n\t\t\t\t\t\ttimeout={ 300 }\n\t\t\t\t\t\tclassNames=\"block-editor-block-toolbar-content\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className={ className } ref={ toolbarRef }>\n\t\t\t\t\t\t\t{ children }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CSSTransition>\n\t\t\t\t) }\n\t\t\t</TransitionGroup>\n\t\t</div>\n\t);\n}\n"]}