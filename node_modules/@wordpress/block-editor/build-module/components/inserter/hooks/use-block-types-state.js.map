{"version":3,"sources":["@wordpress/block-editor/src/components/inserter/hooks/use-block-types-state.js"],"names":["map","useEffect","createBlock","useSelect","createBlocksFromInnerBlocksTemplate","innerBlocksTemplate","name","attributes","innerBlocks","useBlockTypesState","rootClientId","onInsert","select","getInserterItems","getSettings","getCategories","getCollections","__experimentalFetchReusableBlocks","categories","collections","items","fetchReusableBlocks","onSelectItem","initialAttributes","insertedBlock"],"mappings":";;AAAA;;;AAGA,SAASA,GAAT,QAAoB,QAApB;AAEA;;;;AAGA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,WAAT,QAA4B,mBAA5B;AACA,SAASC,SAAT,QAA0B,iBAA1B,C,CAEA;;AACA,IAAMC,mCAAmC,GAAG,SAAtCA,mCAAsC,CAAEC,mBAAF,EAA2B;AACtE,SAAOL,GAAG,CACTK,mBADS,EAET;AAAA;AAAA,QAAIC,IAAJ;AAAA,QAAUC,UAAV;AAAA;AAAA,QAAsBC,WAAtB,uBAAoC,EAApC;;AAAA,WACCN,WAAW,CACVI,IADU,EAEVC,UAFU,EAGVH,mCAAmC,CAAEI,WAAF,CAHzB,CADZ;AAAA,GAFS,CAAV;AASA,CAVD;AAYA;;;;;;;;;AAOA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAEC,YAAF,EAAgBC,QAAhB,EAA8B;AAAA,mBACQR,SAAS,CACxE,UAAES,MAAF,EAAc;AAAA,kBAC6BA,MAAM,CAC/C,mBAD+C,CADnC;AAAA,QACLC,gBADK,WACLA,gBADK;AAAA,QACaC,WADb,WACaA,WADb;;AAAA,mBAI6BF,MAAM,CAAE,aAAF,CAJnC;AAAA,QAILG,aAJK,YAILA,aAJK;AAAA,QAIUC,cAJV,YAIUA,cAJV;;AAAA,uBAKiCF,WAAW,EAL5C;AAAA,QAKLG,iCALK,gBAKLA,iCALK;;AAOb,WAAO;AACNC,MAAAA,UAAU,EAAEH,aAAa,EADnB;AAENI,MAAAA,WAAW,EAAEH,cAAc,EAFrB;AAGNI,MAAAA,KAAK,EAAEP,gBAAgB,CAAEH,YAAF,CAHjB;AAINW,MAAAA,mBAAmB,EAAEJ;AAJf,KAAP;AAMA,GAduE,EAexE,CAAEP,YAAF,CAfwE,CADjB;AAAA,MAChDQ,UADgD,cAChDA,UADgD;AAAA,MACpCC,WADoC,cACpCA,WADoC;AAAA,MACvBC,KADuB,cACvBA,KADuB;AAAA,MAChBC,mBADgB,cAChBA,mBADgB,EAmBxD;;;AACApB,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAKoB,mBAAL,EAA2B;AAC1BA,MAAAA,mBAAmB;AACnB;AACD,GAJQ,EAIN,EAJM,CAAT;;AAMA,MAAMC,YAAY,GAAG,SAAfA,YAAe,QAAgD;AAAA,QAA5ChB,IAA4C,SAA5CA,IAA4C;AAAA,QAAtCiB,iBAAsC,SAAtCA,iBAAsC;AAAA,QAAnBf,WAAmB,SAAnBA,WAAmB;AACpE,QAAMgB,aAAa,GAAGtB,WAAW,CAChCI,IADgC,EAEhCiB,iBAFgC,EAGhCnB,mCAAmC,CAAEI,WAAF,CAHH,CAAjC;AAMAG,IAAAA,QAAQ,CAAEa,aAAF,CAAR;AACA,GARD;;AAUA,SAAO,CAAEJ,KAAF,EAASF,UAAT,EAAqBC,WAArB,EAAkCG,YAAlC,CAAP;AACA,CArCD;;AAuCA,eAAeb,kBAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { map } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect } from '@wordpress/element';\nimport { createBlock } from '@wordpress/blocks';\nimport { useSelect } from '@wordpress/data';\n\n// Copied over from the Columns block. It seems like it should become part of public API.\nconst createBlocksFromInnerBlocksTemplate = ( innerBlocksTemplate ) => {\n\treturn map(\n\t\tinnerBlocksTemplate,\n\t\t( [ name, attributes, innerBlocks = [] ] ) =>\n\t\t\tcreateBlock(\n\t\t\t\tname,\n\t\t\t\tattributes,\n\t\t\t\tcreateBlocksFromInnerBlocksTemplate( innerBlocks )\n\t\t\t)\n\t);\n};\n\n/**\n * Retrieves the block types inserter state.\n *\n * @param {string=}  rootClientId        Insertion's root client ID.\n * @param {Function} onInsert            function called when inserter a list of blocks.\n * @return {Array} Returns the block types state. (block types, categories, collections, onSelect handler)\n */\nconst useBlockTypesState = ( rootClientId, onInsert ) => {\n\tconst { categories, collections, items, fetchReusableBlocks } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getInserterItems, getSettings } = select(\n\t\t\t\t'core/block-editor'\n\t\t\t);\n\t\t\tconst { getCategories, getCollections } = select( 'core/blocks' );\n\t\t\tconst { __experimentalFetchReusableBlocks } = getSettings();\n\n\t\t\treturn {\n\t\t\t\tcategories: getCategories(),\n\t\t\t\tcollections: getCollections(),\n\t\t\t\titems: getInserterItems( rootClientId ),\n\t\t\t\tfetchReusableBlocks: __experimentalFetchReusableBlocks,\n\t\t\t};\n\t\t},\n\t\t[ rootClientId ]\n\t);\n\n\t// Fetch resuable blocks on mount\n\tuseEffect( () => {\n\t\tif ( fetchReusableBlocks ) {\n\t\t\tfetchReusableBlocks();\n\t\t}\n\t}, [] );\n\n\tconst onSelectItem = ( { name, initialAttributes, innerBlocks } ) => {\n\t\tconst insertedBlock = createBlock(\n\t\t\tname,\n\t\t\tinitialAttributes,\n\t\t\tcreateBlocksFromInnerBlocksTemplate( innerBlocks )\n\t\t);\n\n\t\tonInsert( insertedBlock );\n\t};\n\n\treturn [ items, categories, collections, onSelectItem ];\n};\n\nexport default useBlockTypesState;\n"]}