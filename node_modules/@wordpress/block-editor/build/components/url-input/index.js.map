{"version":3,"sources":["@wordpress/block-editor/src/components/url-input/index.js"],"names":["stopEventPropagation","event","stopPropagation","URLInput","props","onChange","bind","onFocus","onKeyDown","selectLink","handleOnClick","bindSuggestionNode","autocompleteRef","inputRef","updateSuggestions","suggestionNodes","isUpdatingSuggestions","state","suggestions","showSuggestions","selectedSuggestion","suggestionsListboxId","suggestionOptionIdPrefix","prevProps","value","scrollingIntoView","current","onlyScrollIfNeeded","setTimeout","shouldShowInitialSuggestions","suggestionsRequest","index","ref","__experimentalShowInitialSuggestions","length","fetchLinkSuggestions","__experimentalFetchLinkSuggestions","handleURLSuggestions","__experimentalHandleURLSuggestions","isInitialSuggestions","setState","loading","request","then","debouncedSpeak","catch","inputValue","target","disableSuggestions","trim","keyCode","UP","selectionStart","preventDefault","setSelectionRange","DOWN","suggestion","previousIndex","nextIndex","TAB","speak","ENTER","url","focus","renderControl","renderSuggestions","label","className","isFullWidth","instanceId","placeholder","__experimentalRenderControl","autoFocus","controlProps","id","inputProps","required","type","onInput","role","undefined","__experimentalRenderSuggestions","suggestionsListProps","buildSuggestionItemProps","tabIndex","isLoading","handleSuggestionClick","map","title","shouldShowSuggestions","hasValue","Component","withSafeTimeout","withSpokenMessages","withInstanceId","select","getSettings"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { throttle, isFunction } from 'lodash';\nimport classnames from 'classnames';\nimport scrollIntoView from 'dom-scroll-into-view';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf, _n } from '@wordpress/i18n';\nimport { Component, createRef } from '@wordpress/element';\nimport { UP, DOWN, ENTER, TAB } from '@wordpress/keycodes';\nimport {\n\tBaseControl,\n\tButton,\n\tSpinner,\n\twithSpokenMessages,\n\tPopover,\n} from '@wordpress/components';\nimport { withInstanceId, withSafeTimeout, compose } from '@wordpress/compose';\nimport { withSelect } from '@wordpress/data';\nimport { isURL } from '@wordpress/url';\n\n// Since URLInput is rendered in the context of other inputs, but should be\n// considered a separate modal node, prevent keyboard events from propagating\n// as being considered from the input.\nconst stopEventPropagation = ( event ) => event.stopPropagation();\n\n/* eslint-disable jsx-a11y/no-autofocus */\nclass URLInput extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.onChange = this.onChange.bind( this );\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\t\tthis.selectLink = this.selectLink.bind( this );\n\t\tthis.handleOnClick = this.handleOnClick.bind( this );\n\t\tthis.bindSuggestionNode = this.bindSuggestionNode.bind( this );\n\t\tthis.autocompleteRef = props.autocompleteRef || createRef();\n\t\tthis.inputRef = createRef();\n\t\tthis.updateSuggestions = throttle(\n\t\t\tthis.updateSuggestions.bind( this ),\n\t\t\t200\n\t\t);\n\n\t\tthis.suggestionNodes = [];\n\n\t\tthis.isUpdatingSuggestions = false;\n\n\t\tthis.state = {\n\t\t\tsuggestions: [],\n\t\t\tshowSuggestions: false,\n\t\t\tselectedSuggestion: null,\n\n\t\t\tsuggestionsListboxId: '',\n\t\t\tsuggestionOptionIdPrefix: '',\n\t\t};\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { showSuggestions, selectedSuggestion } = this.state;\n\t\tconst { value } = this.props;\n\n\t\t// only have to worry about scrolling selected suggestion into view\n\t\t// when already expanded\n\t\tif (\n\t\t\tshowSuggestions &&\n\t\t\tselectedSuggestion !== null &&\n\t\t\tthis.suggestionNodes[ selectedSuggestion ] &&\n\t\t\t! this.scrollingIntoView\n\t\t) {\n\t\t\tthis.scrollingIntoView = true;\n\t\t\tscrollIntoView(\n\t\t\t\tthis.suggestionNodes[ selectedSuggestion ],\n\t\t\t\tthis.autocompleteRef.current,\n\t\t\t\t{\n\t\t\t\t\tonlyScrollIfNeeded: true,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.props.setTimeout( () => {\n\t\t\t\tthis.scrollingIntoView = false;\n\t\t\t}, 100 );\n\t\t}\n\n\t\t// Only attempt an update on suggestions if the input value has actually changed.\n\t\tif (\n\t\t\tprevProps.value !== value &&\n\t\t\tthis.shouldShowInitialSuggestions()\n\t\t) {\n\t\t\tthis.updateSuggestions();\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( this.shouldShowInitialSuggestions() ) {\n\t\t\tthis.updateSuggestions();\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tdelete this.suggestionsRequest;\n\t}\n\n\tbindSuggestionNode( index ) {\n\t\treturn ( ref ) => {\n\t\t\tthis.suggestionNodes[ index ] = ref;\n\t\t};\n\t}\n\n\tshouldShowInitialSuggestions() {\n\t\tconst { suggestions } = this.state;\n\t\tconst {\n\t\t\t__experimentalShowInitialSuggestions = false,\n\t\t\tvalue,\n\t\t} = this.props;\n\t\treturn (\n\t\t\t! this.isUpdatingSuggestions &&\n\t\t\t__experimentalShowInitialSuggestions &&\n\t\t\t! ( value && value.length ) &&\n\t\t\t! ( suggestions && suggestions.length )\n\t\t);\n\t}\n\n\tupdateSuggestions( value = '' ) {\n\t\tconst {\n\t\t\t__experimentalFetchLinkSuggestions: fetchLinkSuggestions,\n\t\t\t__experimentalHandleURLSuggestions: handleURLSuggestions,\n\t\t} = this.props;\n\n\t\tif ( ! fetchLinkSuggestions ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst isInitialSuggestions = ! ( value && value.length );\n\n\t\t// Allow a suggestions request if:\n\t\t// - there are at least 2 characters in the search input (except manual searches where\n\t\t//   search input length is not required to trigger a fetch)\n\t\t// - this is a direct entry (eg: a URL)\n\t\tif (\n\t\t\t! isInitialSuggestions &&\n\t\t\t( value.length < 2 || ( ! handleURLSuggestions && isURL( value ) ) )\n\t\t) {\n\t\t\tthis.setState( {\n\t\t\t\tshowSuggestions: false,\n\t\t\t\tselectedSuggestion: null,\n\t\t\t\tloading: false,\n\t\t\t} );\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isUpdatingSuggestions = true;\n\n\t\tthis.setState( {\n\t\t\tselectedSuggestion: null,\n\t\t\tloading: true,\n\t\t} );\n\n\t\tconst request = fetchLinkSuggestions( value, {\n\t\t\tisInitialSuggestions,\n\t\t} );\n\n\t\trequest\n\t\t\t.then( ( suggestions ) => {\n\t\t\t\t// A fetch Promise doesn't have an abort option. It's mimicked by\n\t\t\t\t// comparing the request reference in on the instance, which is\n\t\t\t\t// reset or deleted on subsequent requests or unmounting.\n\t\t\t\tif ( this.suggestionsRequest !== request ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.setState( {\n\t\t\t\t\tsuggestions,\n\t\t\t\t\tloading: false,\n\t\t\t\t\tshowSuggestions: !! suggestions.length,\n\t\t\t\t} );\n\n\t\t\t\tif ( !! suggestions.length ) {\n\t\t\t\t\tthis.props.debouncedSpeak(\n\t\t\t\t\t\tsprintf(\n\t\t\t\t\t\t\t/* translators: %s: number of results. */\n\t\t\t\t\t\t\t_n(\n\t\t\t\t\t\t\t\t'%d result found, use up and down arrow keys to navigate.',\n\t\t\t\t\t\t\t\t'%d results found, use up and down arrow keys to navigate.',\n\t\t\t\t\t\t\t\tsuggestions.length\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tsuggestions.length\n\t\t\t\t\t\t),\n\t\t\t\t\t\t'assertive'\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tthis.props.debouncedSpeak(\n\t\t\t\t\t\t__( 'No results.' ),\n\t\t\t\t\t\t'assertive'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.isUpdatingSuggestions = false;\n\t\t\t} )\n\t\t\t.catch( () => {\n\t\t\t\tif ( this.suggestionsRequest === request ) {\n\t\t\t\t\tthis.setState( {\n\t\t\t\t\t\tloading: false,\n\t\t\t\t\t} );\n\t\t\t\t\tthis.isUpdatingSuggestions = false;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t// Note that this assignment is handled *before* the async search request\n\t\t// as a Promise always resolves on the next tick of the event loop.\n\t\tthis.suggestionsRequest = request;\n\t}\n\n\tonChange( event ) {\n\t\tconst inputValue = event.target.value;\n\n\t\tthis.props.onChange( inputValue );\n\t\tif ( ! this.props.disableSuggestions ) {\n\t\t\tthis.updateSuggestions( inputValue.trim() );\n\t\t}\n\t}\n\n\tonFocus() {\n\t\tconst { suggestions } = this.state;\n\t\tconst { disableSuggestions, value } = this.props;\n\n\t\t// When opening the link editor, if there's a value present, we want to load the suggestions pane with the results for this input search value\n\t\t// Don't re-run the suggestions on focus if there are already suggestions present (prevents searching again when tabbing between the input and buttons)\n\t\tif (\n\t\t\tvalue &&\n\t\t\t! disableSuggestions &&\n\t\t\t! this.isUpdatingSuggestions &&\n\t\t\t! ( suggestions && suggestions.length )\n\t\t) {\n\t\t\t// Ensure the suggestions are updated with the current input value\n\t\t\tthis.updateSuggestions( value.trim() );\n\t\t}\n\t}\n\n\tonKeyDown( event ) {\n\t\tconst {\n\t\t\tshowSuggestions,\n\t\t\tselectedSuggestion,\n\t\t\tsuggestions,\n\t\t\tloading,\n\t\t} = this.state;\n\n\t\t// If the suggestions are not shown or loading, we shouldn't handle the arrow keys\n\t\t// We shouldn't preventDefault to allow block arrow keys navigation\n\t\tif ( ! showSuggestions || ! suggestions.length || loading ) {\n\t\t\t// In the Windows version of Firefox the up and down arrows don't move the caret\n\t\t\t// within an input field like they do for Mac Firefox/Chrome/Safari. This causes\n\t\t\t// a form of focus trapping that is disruptive to the user experience. This disruption\n\t\t\t// only happens if the caret is not in the first or last position in the text input.\n\t\t\t// See: https://github.com/WordPress/gutenberg/issues/5693#issuecomment-436684747\n\t\t\tswitch ( event.keyCode ) {\n\t\t\t\t// When UP is pressed, if the caret is at the start of the text, move it to the 0\n\t\t\t\t// position.\n\t\t\t\tcase UP: {\n\t\t\t\t\tif ( 0 !== event.target.selectionStart ) {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t// Set the input caret to position 0\n\t\t\t\t\t\tevent.target.setSelectionRange( 0, 0 );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t// When DOWN is pressed, if the caret is not at the end of the text, move it to the\n\t\t\t\t// last position.\n\t\t\t\tcase DOWN: {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.props.value.length !== event.target.selectionStart\n\t\t\t\t\t) {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t// Set the input caret to the last position\n\t\t\t\t\t\tevent.target.setSelectionRange(\n\t\t\t\t\t\t\tthis.props.value.length,\n\t\t\t\t\t\t\tthis.props.value.length\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst suggestion = this.state.suggestions[\n\t\t\tthis.state.selectedSuggestion\n\t\t];\n\n\t\tswitch ( event.keyCode ) {\n\t\t\tcase UP: {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst previousIndex = ! selectedSuggestion\n\t\t\t\t\t? suggestions.length - 1\n\t\t\t\t\t: selectedSuggestion - 1;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tselectedSuggestion: previousIndex,\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase DOWN: {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst nextIndex =\n\t\t\t\t\tselectedSuggestion === null ||\n\t\t\t\t\tselectedSuggestion === suggestions.length - 1\n\t\t\t\t\t\t? 0\n\t\t\t\t\t\t: selectedSuggestion + 1;\n\t\t\t\tthis.setState( {\n\t\t\t\t\tselectedSuggestion: nextIndex,\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase TAB: {\n\t\t\t\tif ( this.state.selectedSuggestion !== null ) {\n\t\t\t\t\tthis.selectLink( suggestion );\n\t\t\t\t\t// Announce a link has been selected when tabbing away from the input field.\n\t\t\t\t\tthis.props.speak( __( 'Link selected.' ) );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase ENTER: {\n\t\t\t\tif ( this.state.selectedSuggestion !== null ) {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tthis.selectLink( suggestion );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tselectLink( suggestion ) {\n\t\tthis.props.onChange( suggestion.url, suggestion );\n\t\tthis.setState( {\n\t\t\tselectedSuggestion: null,\n\t\t\tshowSuggestions: false,\n\t\t} );\n\t}\n\n\thandleOnClick( suggestion ) {\n\t\tthis.selectLink( suggestion );\n\t\t// Move focus to the input field when a link suggestion is clicked.\n\t\tthis.inputRef.current.focus();\n\t}\n\n\tstatic getDerivedStateFromProps(\n\t\t{\n\t\t\tvalue,\n\t\t\tinstanceId,\n\t\t\tdisableSuggestions,\n\t\t\t__experimentalShowInitialSuggestions = false,\n\t\t},\n\t\t{ showSuggestions }\n\t) {\n\t\tlet shouldShowSuggestions = showSuggestions;\n\n\t\tconst hasValue = value && value.length;\n\n\t\tif ( ! __experimentalShowInitialSuggestions && ! hasValue ) {\n\t\t\tshouldShowSuggestions = false;\n\t\t}\n\n\t\tif ( disableSuggestions === true ) {\n\t\t\tshouldShowSuggestions = false;\n\t\t}\n\n\t\treturn {\n\t\t\tshowSuggestions: shouldShowSuggestions,\n\t\t\tsuggestionsListboxId: `block-editor-url-input-suggestions-${ instanceId }`,\n\t\t\tsuggestionOptionIdPrefix: `block-editor-url-input-suggestion-${ instanceId }`,\n\t\t};\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ this.renderControl() }\n\t\t\t\t{ this.renderSuggestions() }\n\t\t\t</>\n\t\t);\n\t}\n\n\trenderControl() {\n\t\tconst {\n\t\t\tlabel,\n\t\t\tclassName,\n\t\t\tisFullWidth,\n\t\t\tinstanceId,\n\t\t\tplaceholder = __( 'Paste URL or type to search' ),\n\t\t\t__experimentalRenderControl: renderControl,\n\t\t\tvalue = '',\n\t\t\tautoFocus = true,\n\t\t} = this.props;\n\n\t\tconst {\n\t\t\tloading,\n\t\t\tshowSuggestions,\n\t\t\tselectedSuggestion,\n\t\t\tsuggestionsListboxId,\n\t\t\tsuggestionOptionIdPrefix,\n\t\t} = this.state;\n\n\t\tconst controlProps = {\n\t\t\tid: `url-input-control-${ instanceId }`,\n\t\t\tlabel,\n\t\t\tclassName: classnames( 'block-editor-url-input', className, {\n\t\t\t\t'is-full-width': isFullWidth,\n\t\t\t} ),\n\t\t};\n\n\t\tconst inputProps = {\n\t\t\tvalue,\n\t\t\trequired: true,\n\t\t\tautoFocus,\n\t\t\tclassName: 'block-editor-url-input__input',\n\t\t\ttype: 'text',\n\t\t\tonChange: this.onChange,\n\t\t\tonFocus: this.onFocus,\n\t\t\tonInput: stopEventPropagation,\n\t\t\tplaceholder,\n\t\t\tonKeyDown: this.onKeyDown,\n\t\t\trole: 'combobox',\n\t\t\t'aria-label': __( 'URL' ),\n\t\t\t'aria-expanded': showSuggestions,\n\t\t\t'aria-autocomplete': 'list',\n\t\t\t'aria-owns': suggestionsListboxId,\n\t\t\t'aria-activedescendant':\n\t\t\t\tselectedSuggestion !== null\n\t\t\t\t\t? `${ suggestionOptionIdPrefix }-${ selectedSuggestion }`\n\t\t\t\t\t: undefined,\n\t\t\tref: this.inputRef,\n\t\t};\n\n\t\tif ( renderControl ) {\n\t\t\treturn renderControl( controlProps, inputProps, loading );\n\t\t}\n\n\t\treturn (\n\t\t\t<BaseControl { ...controlProps }>\n\t\t\t\t<input { ...inputProps } />\n\t\t\t\t{ loading && <Spinner /> }\n\t\t\t</BaseControl>\n\t\t);\n\t}\n\n\trenderSuggestions() {\n\t\tconst {\n\t\t\tclassName,\n\t\t\t__experimentalRenderSuggestions: renderSuggestions,\n\t\t\tvalue = '',\n\t\t\t__experimentalShowInitialSuggestions = false,\n\t\t} = this.props;\n\n\t\tconst {\n\t\t\tshowSuggestions,\n\t\t\tsuggestions,\n\t\t\tselectedSuggestion,\n\t\t\tsuggestionsListboxId,\n\t\t\tsuggestionOptionIdPrefix,\n\t\t\tloading,\n\t\t} = this.state;\n\n\t\tconst suggestionsListProps = {\n\t\t\tid: suggestionsListboxId,\n\t\t\tref: this.autocompleteRef,\n\t\t\trole: 'listbox',\n\t\t};\n\n\t\tconst buildSuggestionItemProps = ( suggestion, index ) => {\n\t\t\treturn {\n\t\t\t\trole: 'option',\n\t\t\t\ttabIndex: '-1',\n\t\t\t\tid: `${ suggestionOptionIdPrefix }-${ index }`,\n\t\t\t\tref: this.bindSuggestionNode( index ),\n\t\t\t\t'aria-selected': index === selectedSuggestion,\n\t\t\t};\n\t\t};\n\n\t\tif (\n\t\t\tisFunction( renderSuggestions ) &&\n\t\t\tshowSuggestions &&\n\t\t\t!! suggestions.length\n\t\t) {\n\t\t\treturn renderSuggestions( {\n\t\t\t\tsuggestions,\n\t\t\t\tselectedSuggestion,\n\t\t\t\tsuggestionsListProps,\n\t\t\t\tbuildSuggestionItemProps,\n\t\t\t\tisLoading: loading,\n\t\t\t\thandleSuggestionClick: this.handleOnClick,\n\t\t\t\tisInitialSuggestions:\n\t\t\t\t\t__experimentalShowInitialSuggestions &&\n\t\t\t\t\t! ( value && value.length ),\n\t\t\t} );\n\t\t}\n\n\t\tif (\n\t\t\t! isFunction( renderSuggestions ) &&\n\t\t\tshowSuggestions &&\n\t\t\t!! suggestions.length\n\t\t) {\n\t\t\treturn (\n\t\t\t\t<Popover position=\"bottom\" noArrow focusOnMount={ false }>\n\t\t\t\t\t<div\n\t\t\t\t\t\t{ ...suggestionsListProps }\n\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t'block-editor-url-input__suggestions',\n\t\t\t\t\t\t\t`${ className }__suggestions`\n\t\t\t\t\t\t) }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ suggestions.map( ( suggestion, index ) => (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t{ ...buildSuggestionItemProps(\n\t\t\t\t\t\t\t\t\tsuggestion,\n\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\tkey={ suggestion.id }\n\t\t\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t\t\t'block-editor-url-input__suggestion',\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t'is-selected':\n\t\t\t\t\t\t\t\t\t\t\tindex === selectedSuggestion,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\tonClick={ () =>\n\t\t\t\t\t\t\t\t\tthis.handleOnClick( suggestion )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ suggestion.title }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t) ) }\n\t\t\t\t\t</div>\n\t\t\t\t</Popover>\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n}\n/* eslint-enable jsx-a11y/no-autofocus */\n\n/**\n * @see https://github.com/WordPress/gutenberg/blob/master/packages/block-editor/src/components/url-input/README.md\n */\nexport default compose(\n\twithSafeTimeout,\n\twithSpokenMessages,\n\twithInstanceId,\n\twithSelect( ( select, props ) => {\n\t\t// If a link suggestions handler is already provided then\n\t\t// bail\n\t\tif ( isFunction( props.__experimentalFetchLinkSuggestions ) ) {\n\t\t\treturn;\n\t\t}\n\t\tconst { getSettings } = select( 'core/block-editor' );\n\t\treturn {\n\t\t\t__experimentalFetchLinkSuggestions: getSettings()\n\t\t\t\t.__experimentalFetchLinkSuggestions,\n\t\t};\n\t} )\n)( URLInput );\n"]}